
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Field &#8212; ubermag  documentation</title>
    
  <link href="../../_static/css/theme.css" rel="stylesheet" />
  <link href="../../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/basic.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/plot_directive.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "document", "processHtmlClass": "math|output_area"}}</script>
    <link rel="shortcut icon" href="../../_static/logo.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Line" href="discretisedfield.Line.html" />
    <link rel="prev" title="DValue" href="discretisedfield.DValue.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">

  <div id="navbar-start">
    
    

<a class="navbar-brand" href="../../index.html">
  <img src="../../_static/logoL.svg" class="logo" alt="logo">
</a>


    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../installation.html">
  Installation
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../quickstart.html">
  Quickstart
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../workshop/index.html">
  Workshop
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../documentation/index.html">
  Documentation
 </a>
</li>

<li class="toctree-l1 current active nav-item">
 <a class="reference internal nav-link" href="../index.html">
  API Reference
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../changelog.html">
  Changelog
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../help.html">
  Help
 </a>
</li>

    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/ubermag" rel="noopener" target="_blank" title="GitHub">
            <span><i class="fab fa-github-square"></i></span>
            <label class="sr-only">GitHub</label>
          </a>
        </li>
      </ul>
      </div>
      
      <div class="navbar-end-item">
        <form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar"><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    <p class="caption" role="heading">
 <span class="caption-text">
  Packages
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="../discretisedfield.html">
   discretisedfield
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2 current active has-children">
    <a class="reference internal" href="discretisedfield.html">
     discretisedfield
    </a>
    <input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
    <label for="toctree-checkbox-2">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul class="current">
     <li class="toctree-l3">
      <a class="reference internal" href="discretisedfield.DValue.html">
       DValue
      </a>
     </li>
     <li class="toctree-l3 current active">
      <a class="current reference internal" href="#">
       Field
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="discretisedfield.Line.html">
       Line
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="discretisedfield.Mesh.html">
       Mesh
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="discretisedfield.Region.html">
       Region
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="discretisedfield.integral.html">
       discretisedfield.integral
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="discretisedfield.interact.html">
       discretisedfield.interact
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="discretisedfield.test.html">
       discretisedfield.test
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="discretisedfield.tools.html">
     discretisedfield.tools
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
    <label for="toctree-checkbox-3">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="discretisedfield.tools.count_bps.html">
       discretisedfield.tools.count_bps
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="discretisedfield.tools.count_large_cell_angle_regions.html">
       discretisedfield.tools.count_large_cell_angle_regions
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="discretisedfield.tools.emergent_magnetic_field.html">
       discretisedfield.tools.emergent_magnetic_field
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="discretisedfield.tools.max_neigbouring_cell_angle.html">
       discretisedfield.tools.max_neigbouring_cell_angle
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="discretisedfield.tools.neigbouring_cell_angle.html">
       discretisedfield.tools.neigbouring_cell_angle
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="discretisedfield.tools.topological_charge.html">
       discretisedfield.tools.topological_charge
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="discretisedfield.tools.topological_charge_density.html">
       discretisedfield.tools.topological_charge_density
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="discretisedfield.ovf2vtk.html">
     discretisedfield.ovf2vtk
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
    <label for="toctree-checkbox-4">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="discretisedfield.ovf2vtk.ovf2vtk.html">
       discretisedfield.ovf2vtk.ovf2vtk
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../micromagneticdata.html">
   micromagneticdata
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="micromagneticdata.html">
     micromagneticdata
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
    <label for="toctree-checkbox-6">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="micromagneticdata.Data.html">
       Data
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="micromagneticdata.Drive.html">
       Drive
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="micromagneticdata.test.html">
       micromagneticdata.test
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../micromagneticmodel.html">
   micromagneticmodel
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="micromagneticmodel.html">
     micromagneticmodel
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
    <label for="toctree-checkbox-8">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="micromagneticmodel.CubicAnisotropy.html">
       CubicAnisotropy
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="micromagneticmodel.DMI.html">
       DMI
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="micromagneticmodel.Damping.html">
       Damping
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="micromagneticmodel.Demag.html">
       Demag
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="micromagneticmodel.Driver.html">
       Driver
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="micromagneticmodel.Dynamics.html">
       Dynamics
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="micromagneticmodel.DynamicsTerm.html">
       DynamicsTerm
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="micromagneticmodel.Energy.html">
       Energy
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="micromagneticmodel.EnergyTerm.html">
       EnergyTerm
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="micromagneticmodel.Evolver.html">
       Evolver
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="micromagneticmodel.Exchange.html">
       Exchange
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="micromagneticmodel.MagnetoElastic.html">
       MagnetoElastic
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="micromagneticmodel.Precession.html">
       Precession
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="micromagneticmodel.RKKY.html">
       RKKY
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="micromagneticmodel.Slonczewski.html">
       Slonczewski
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="micromagneticmodel.System.html">
       System
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="micromagneticmodel.UniaxialAnisotropy.html">
       UniaxialAnisotropy
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="micromagneticmodel.Zeeman.html">
       Zeeman
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="micromagneticmodel.ZhangLi.html">
       ZhangLi
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="micromagneticmodel.test.html">
       micromagneticmodel.test
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="micromagneticmodel.abstract.html">
     micromagneticmodel.abstract
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
    <label for="toctree-checkbox-9">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="micromagneticmodel.abstract.Abstract.html">
       Abstract
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="micromagneticmodel.abstract.Container.html">
       Container
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="micromagneticmodel.abstract.Term.html">
       Term
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="micromagneticmodel.consts.html">
     micromagneticmodel.consts
    </a>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="micromagneticmodel.examples.html">
     micromagneticmodel.examples
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
    <label for="toctree-checkbox-10">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="micromagneticmodel.examples.macrospin.html">
       micromagneticmodel.examples.macrospin
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../micromagnetictests.html">
   micromagnetictests
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/>
  <label for="toctree-checkbox-11">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="micromagnetictests.html">
     micromagnetictests
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/>
    <label for="toctree-checkbox-12">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="micromagnetictests.get_tests.html">
       micromagnetictests.get_tests
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="micromagnetictests.test.html">
       micromagnetictests.test
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="micromagnetictests.calculatortests.html">
     micromagnetictests.calculatortests
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/>
    <label for="toctree-checkbox-13">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="micromagnetictests.calculatortests.TestCompute.html">
       TestCompute
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="micromagnetictests.calculatortests.TestCubicAnisotropy.html">
       TestCubicAnisotropy
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="micromagnetictests.calculatortests.TestDMI.html">
       TestDMI
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="micromagnetictests.calculatortests.TestDamping.html">
       TestDamping
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="micromagnetictests.calculatortests.TestDemag.html">
       TestDemag
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="micromagnetictests.calculatortests.TestDynamics.html">
       TestDynamics
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="micromagnetictests.calculatortests.TestEnergy.html">
       TestEnergy
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="micromagnetictests.calculatortests.TestExchange.html">
       TestExchange
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="micromagnetictests.calculatortests.TestFixedSubregions.html">
       TestFixedSubregions
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="micromagnetictests.calculatortests.TestHysteresisDriver.html">
       TestHysteresisDriver
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="micromagnetictests.calculatortests.TestMesh.html">
       TestMesh
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="micromagnetictests.calculatortests.TestMinDriver.html">
       TestMinDriver
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="micromagnetictests.calculatortests.TestPrecession.html">
       TestPrecession
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="micromagnetictests.calculatortests.TestRKKY.html">
       TestRKKY
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="micromagnetictests.calculatortests.TestSlonczewski.html">
       TestSlonczewski
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="micromagnetictests.calculatortests.TestThreads.html">
       TestThreads
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="micromagnetictests.calculatortests.TestTimeDriver.html">
       TestTimeDriver
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="micromagnetictests.calculatortests.TestUniaxialAnisotropy.html">
       TestUniaxialAnisotropy
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="micromagnetictests.calculatortests.TestZeeman.html">
       TestZeeman
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="micromagnetictests.calculatortests.TestZhangLi.html">
       TestZhangLi
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="micromagnetictests.calculatortests.test_dirname.html">
       micromagnetictests.calculatortests.test_dirname
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="micromagnetictests.calculatortests.test_info_file.html">
       micromagnetictests.calculatortests.test_info_file
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="micromagnetictests.calculatortests.test_multiple_drives.html">
       micromagnetictests.calculatortests.test_multiple_drives
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="micromagnetictests.calculatortests.test_outputstep.html">
       micromagnetictests.calculatortests.test_outputstep
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="micromagnetictests.calculatortests.test_stdprob3.html">
       micromagnetictests.calculatortests.test_stdprob3
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="micromagnetictests.calculatortests.test_stdprob4.html">
       micromagnetictests.calculatortests.test_stdprob4
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="micromagnetictests.calculatortests.test_stdprob5.html">
       micromagnetictests.calculatortests.test_stdprob5
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../oommfc.html">
   oommfc
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/>
  <label for="toctree-checkbox-14">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="oommfc.html">
     oommfc
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" type="checkbox"/>
    <label for="toctree-checkbox-15">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="oommfc.CGEvolver.html">
       CGEvolver
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="oommfc.Driver.html">
       Driver
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="oommfc.EulerEvolver.html">
       EulerEvolver
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="oommfc.HysteresisDriver.html">
       HysteresisDriver
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="oommfc.MinDriver.html">
       MinDriver
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="oommfc.RungeKuttaEvolver.html">
       RungeKuttaEvolver
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="oommfc.SpinTEvolver.html">
       SpinTEvolver
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="oommfc.SpinXferEvolver.html">
       SpinXferEvolver
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="oommfc.TimeDriver.html">
       TimeDriver
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="oommfc.compute.html">
       oommfc.compute
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="oommfc.delete.html">
       oommfc.delete
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="oommfc.test.html">
       oommfc.test
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="oommfc.test_docker.html">
       oommfc.test_docker
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="oommfc.oommf.html">
     oommfc.oommf
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" type="checkbox"/>
    <label for="toctree-checkbox-16">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="oommfc.oommf.DockerOOMMFRunner.html">
       DockerOOMMFRunner
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="oommfc.oommf.ExeOOMMFRunner.html">
       ExeOOMMFRunner
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="oommfc.oommf.OOMMFRunner.html">
       OOMMFRunner
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="oommfc.oommf.TclOOMMFRunner.html">
       TclOOMMFRunner
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="oommfc.oommf.get_oommf_runner.html">
       oommfc.oommf.get_oommf_runner
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="oommfc.oommf.overhead.html">
       oommfc.oommf.overhead
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="oommfc.oommf.status.html">
       oommfc.oommf.status
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../ubermag.html">
   ubermag
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" type="checkbox"/>
  <label for="toctree-checkbox-17">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="ubermag.html">
     ubermag
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" type="checkbox"/>
    <label for="toctree-checkbox-18">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="ubermag.test.html">
       ubermag.test
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../ubermagtable.html">
   ubermagtable
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" type="checkbox"/>
  <label for="toctree-checkbox-19">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="ubermagtable.html">
     ubermagtable
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" type="checkbox"/>
    <label for="toctree-checkbox-20">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="ubermagtable.Table.html">
       Table
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="ubermagtable.interact.html">
       ubermagtable.interact
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="ubermagtable.test.html">
       ubermagtable.test
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="ubermagtable.util.html">
     ubermagtable.util
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-21" name="toctree-checkbox-21" type="checkbox"/>
    <label for="toctree-checkbox-21">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="ubermagtable.util.columns.html">
       ubermagtable.util.columns
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="ubermagtable.util.data.html">
       ubermagtable.util.data
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="ubermagtable.util.units.html">
       ubermagtable.util.units
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../ubermagutil.html">
   ubermagutil
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-22" name="toctree-checkbox-22" type="checkbox"/>
  <label for="toctree-checkbox-22">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="ubermagutil.html">
     ubermagutil
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-23" name="toctree-checkbox-23" type="checkbox"/>
    <label for="toctree-checkbox-23">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="ubermagutil.hysteresis_values.html">
       ubermagutil.hysteresis_values
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="ubermagutil.inherit_docs.html">
       ubermagutil.inherit_docs
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="ubermagutil.test.html">
       ubermagutil.test
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="ubermagutil.typesystem.html">
     ubermagutil.typesystem
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-24" name="toctree-checkbox-24" type="checkbox"/>
    <label for="toctree-checkbox-24">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="ubermagutil.typesystem.Descriptor.html">
       Descriptor
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="ubermagutil.typesystem.Dictionary.html">
       Dictionary
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="ubermagutil.typesystem.Name.html">
       Name
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="ubermagutil.typesystem.Parameter.html">
       Parameter
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="ubermagutil.typesystem.Scalar.html">
       Scalar
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="ubermagutil.typesystem.Subset.html">
       Subset
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="ubermagutil.typesystem.Typed.html">
       Typed
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="ubermagutil.typesystem.Vector.html">
       Vector
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="ubermagutil.typesystem.typesystem.html">
       ubermagutil.typesystem.typesystem
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="ubermagutil.units.html">
     ubermagutil.units
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-25" name="toctree-checkbox-25" type="checkbox"/>
    <label for="toctree-checkbox-25">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="ubermagutil.units.si_max_multiplier.html">
       ubermagutil.units.si_max_multiplier
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="ubermagutil.units.si_multiplier.html">
       ubermagutil.units.si_multiplier
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
</ul>

  </div>
</nav>
            </div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
            
              
              <div class="toc-item">
                

<nav id="bd-toc-nav">
    
</nav>
              </div>
              
              <div class="toc-item">
                
              </div>
              
            
          </div>
          

          
          
            
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <div class="section" id="field">
<h1>Field<a class="headerlink" href="#field" title="Permalink to this headline">¶</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="discretisedfield.Field">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">discretisedfield.</span></span><span class="sig-name descname"><span class="pre">Field</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mesh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#discretisedfield.Field" title="Permalink to this definition">¶</a></dt>
<dd><p>Finite-difference field.</p>
<p>This class specifies a finite-difference field and defines operations for
its analysis and visualisation. The field is defined on a finite-difference
mesh (<cite>discretisedfield.Mesh</cite>) passed using <code class="docutils literal notranslate"><span class="pre">mesh</span></code>. Another value that
must be passed is the dimension of the field’s value using <code class="docutils literal notranslate"><span class="pre">dim</span></code>. For
instance, for a scalar field, <code class="docutils literal notranslate"><span class="pre">dim=1</span></code> and for a three-dimensional vector
field <code class="docutils literal notranslate"><span class="pre">dim=3</span></code> must be passed. The value of the field can be set by
passing <code class="docutils literal notranslate"><span class="pre">value</span></code>. For details on how the value can be defined, refer to
<code class="docutils literal notranslate"><span class="pre">discretisedfield.Field.value</span></code>. Similarly, if the field has <code class="docutils literal notranslate"><span class="pre">dim&gt;1</span></code>,
the field can be normalised by passing <code class="docutils literal notranslate"><span class="pre">norm</span></code>. For details on setting the
norm, please refer to <code class="docutils literal notranslate"><span class="pre">discretisedfield.Field.norm</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mesh</strong> (<a class="reference internal" href="discretisedfield.Mesh.html#discretisedfield.Mesh" title="discretisedfield.Mesh"><em>discretisedfield.Mesh</em></a>) – Finite-difference rectangular mesh.</p></li>
<li><p><strong>dim</strong> (<em>int</em>) – Dimension of the field’s value. For instance, if <cite>dim=3</cite> the field is a
three-dimensional vector field and for <cite>dim=1</cite> the field is a scalar
field.</p></li>
<li><p><strong>value</strong> (<em>array_like</em><em>, </em><em>callable</em><em>, </em><em>dict</em><em>, </em><em>optional</em>) – Please refer to <code class="docutils literal notranslate"><span class="pre">discretisedfield.Field.value</span></code> property. Defaults to
0, meaning that if the value is not provided in the initialisation,
“zero-field” will be defined.</p></li>
<li><p><strong>norm</strong> (<em>numbers.Real</em><em>, </em><em>callable</em><em>, </em><em>optional</em>) – Please refer to <code class="docutils literal notranslate"><span class="pre">discretisedfield.Field.norm</span></code> property. Defaults to
<code class="docutils literal notranslate"><span class="pre">None</span></code> (<code class="docutils literal notranslate"><span class="pre">norm=None</span></code> defines no norm).</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>1. Defining a uniform three-dimensional vector field on a nano-sized thin
film.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">discretisedfield</span> <span class="k">as</span> <span class="nn">df</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p1</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mf">50e-9</span><span class="p">,</span> <span class="o">-</span><span class="mf">25e-9</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p2</span> <span class="o">=</span> <span class="p">(</span><span class="mf">50e-9</span><span class="p">,</span> <span class="mf">25e-9</span><span class="p">,</span> <span class="mf">5e-9</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cell</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1e-9</span><span class="p">,</span> <span class="mf">1e-9</span><span class="p">,</span> <span class="mf">0.1e-9</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Mesh</span><span class="p">(</span><span class="n">region</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">Region</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="n">p2</span><span class="p">),</span> <span class="n">cell</span><span class="o">=</span><span class="n">cell</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dim</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">value</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="o">=</span><span class="n">mesh</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="n">dim</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">value</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span>
<span class="go">Field(mesh=...)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span><span class="o">.</span><span class="n">average</span>
<span class="go">(0.0, 0.0, 1.0)</span>
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>Defining a scalar field.</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">p1</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Mesh</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="n">p2</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dim</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">value</span> <span class="o">=</span> <span class="mf">3.14</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="o">=</span><span class="n">mesh</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="n">dim</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">value</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span>
<span class="go">Field(mesh=...)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span><span class="o">.</span><span class="n">average</span>
<span class="go">3.14</span>
</pre></div>
</div>
<ol class="arabic simple" start="3">
<li><p>Defining a uniform three-dimensional normalised vector field.</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">discretisedfield</span> <span class="k">as</span> <span class="nn">df</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p1</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mf">50e9</span><span class="p">,</span> <span class="o">-</span><span class="mf">25e9</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p2</span> <span class="o">=</span> <span class="p">(</span><span class="mf">50e9</span><span class="p">,</span> <span class="mf">25e9</span><span class="p">,</span> <span class="mf">5e9</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cell</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1e9</span><span class="p">,</span> <span class="mf">1e9</span><span class="p">,</span> <span class="mf">0.1e9</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Mesh</span><span class="p">(</span><span class="n">region</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">Region</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="n">p2</span><span class="p">),</span> <span class="n">cell</span><span class="o">=</span><span class="n">cell</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dim</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">value</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">norm</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="o">=</span><span class="n">mesh</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="n">dim</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">value</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span>
<span class="go">Field(mesh=...)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span><span class="o">.</span><span class="n">average</span>
<span class="go">(0.0, 0.0, 1.0)</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="discretisedfield.Mesh.html#discretisedfield.Mesh" title="discretisedfield.Mesh"><code class="xref py py-func docutils literal notranslate"><span class="pre">Mesh()</span></code></a></p>
</div>
<hr><p class="rubric">Methods</p>
<table class="longtable table autosummary">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#discretisedfield.Field.__abs__" title="discretisedfield.Field.__abs__"><code class="xref py py-obj docutils literal notranslate"><span class="pre">__abs__</span></code></a></p></td>
<td><p>Field norm.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#discretisedfield.Field.__add__" title="discretisedfield.Field.__add__"><code class="xref py py-obj docutils literal notranslate"><span class="pre">__add__</span></code></a></p></td>
<td><p>Binary <code class="docutils literal notranslate"><span class="pre">+</span></code> operator.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#discretisedfield.Field.__and__" title="discretisedfield.Field.__and__"><code class="xref py py-obj docutils literal notranslate"><span class="pre">__and__</span></code></a></p></td>
<td><p>Binary <code class="docutils literal notranslate"><span class="pre">&amp;</span></code> operator, defined as cross product.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#discretisedfield.Field.__call__" title="discretisedfield.Field.__call__"><code class="xref py py-obj docutils literal notranslate"><span class="pre">__call__</span></code></a></p></td>
<td><p>Sample the field value at <code class="docutils literal notranslate"><span class="pre">point</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#discretisedfield.Field.__dir__" title="discretisedfield.Field.__dir__"><code class="xref py py-obj docutils literal notranslate"><span class="pre">__dir__</span></code></a></p></td>
<td><p>Extension of the <code class="docutils literal notranslate"><span class="pre">dir(self)</span></code> list.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#discretisedfield.Field.__eq__" title="discretisedfield.Field.__eq__"><code class="xref py py-obj docutils literal notranslate"><span class="pre">__eq__</span></code></a></p></td>
<td><p>Relational operator <code class="docutils literal notranslate"><span class="pre">==</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#discretisedfield.Field.__getattr__" title="discretisedfield.Field.__getattr__"><code class="xref py py-obj docutils literal notranslate"><span class="pre">__getattr__</span></code></a></p></td>
<td><p>Extracting the component of the vector field.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#discretisedfield.Field.__getitem__" title="discretisedfield.Field.__getitem__"><code class="xref py py-obj docutils literal notranslate"><span class="pre">__getitem__</span></code></a></p></td>
<td><p>Extracts the field on a subregion.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#discretisedfield.Field.__iter__" title="discretisedfield.Field.__iter__"><code class="xref py py-obj docutils literal notranslate"><span class="pre">__iter__</span></code></a></p></td>
<td><p>Generator yielding coordinates and values of all mesh discretisation cells.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#discretisedfield.Field.__lshift__" title="discretisedfield.Field.__lshift__"><code class="xref py py-obj docutils literal notranslate"><span class="pre">__lshift__</span></code></a></p></td>
<td><p>Stacks multiple scalar fields in a single vector field.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#discretisedfield.Field.__matmul__" title="discretisedfield.Field.__matmul__"><code class="xref py py-obj docutils literal notranslate"><span class="pre">__matmul__</span></code></a></p></td>
<td><p>Binary <code class="docutils literal notranslate"><span class="pre">&#64;</span></code> operator, defined as dot product.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#discretisedfield.Field.__mul__" title="discretisedfield.Field.__mul__"><code class="xref py py-obj docutils literal notranslate"><span class="pre">__mul__</span></code></a></p></td>
<td><p>Binary <code class="docutils literal notranslate"><span class="pre">*</span></code> operator.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#discretisedfield.Field.__neg__" title="discretisedfield.Field.__neg__"><code class="xref py py-obj docutils literal notranslate"><span class="pre">__neg__</span></code></a></p></td>
<td><p>Unary <code class="docutils literal notranslate"><span class="pre">-</span></code> operator.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#discretisedfield.Field.__pos__" title="discretisedfield.Field.__pos__"><code class="xref py py-obj docutils literal notranslate"><span class="pre">__pos__</span></code></a></p></td>
<td><p>Unary <code class="docutils literal notranslate"><span class="pre">+</span></code> operator.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#discretisedfield.Field.__pow__" title="discretisedfield.Field.__pow__"><code class="xref py py-obj docutils literal notranslate"><span class="pre">__pow__</span></code></a></p></td>
<td><p>Unary <code class="docutils literal notranslate"><span class="pre">**</span></code> operator.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#discretisedfield.Field.__repr__" title="discretisedfield.Field.__repr__"><code class="xref py py-obj docutils literal notranslate"><span class="pre">__repr__</span></code></a></p></td>
<td><p>Representation string.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#discretisedfield.Field.__sub__" title="discretisedfield.Field.__sub__"><code class="xref py py-obj docutils literal notranslate"><span class="pre">__sub__</span></code></a></p></td>
<td><p>Binary <code class="docutils literal notranslate"><span class="pre">-</span></code> operator.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#discretisedfield.Field.__truediv__" title="discretisedfield.Field.__truediv__"><code class="xref py py-obj docutils literal notranslate"><span class="pre">__truediv__</span></code></a></p></td>
<td><p>Binary <code class="docutils literal notranslate"><span class="pre">/</span></code> operator.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#discretisedfield.Field.allclose" title="discretisedfield.Field.allclose"><code class="xref py py-obj docutils literal notranslate"><span class="pre">allclose</span></code></a></p></td>
<td><p>Allclose method.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#discretisedfield.Field.derivative" title="discretisedfield.Field.derivative"><code class="xref py py-obj docutils literal notranslate"><span class="pre">derivative</span></code></a></p></td>
<td><p>Directional derivative.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#discretisedfield.Field.fromfile" title="discretisedfield.Field.fromfile"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fromfile</span></code></a></p></td>
<td><p>Read the field from an OVF (1.0 or 2.0), VTK, or HDF5 file.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#discretisedfield.Field.integral" title="discretisedfield.Field.integral"><code class="xref py py-obj docutils literal notranslate"><span class="pre">integral</span></code></a></p></td>
<td><p>Integral.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#discretisedfield.Field.k3d_nonzero" title="discretisedfield.Field.k3d_nonzero"><code class="xref py py-obj docutils literal notranslate"><span class="pre">k3d_nonzero</span></code></a></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">k3d</span></code> plot of non-zero discretisation cells.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#discretisedfield.Field.k3d_scalar" title="discretisedfield.Field.k3d_scalar"><code class="xref py py-obj docutils literal notranslate"><span class="pre">k3d_scalar</span></code></a></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">k3d</span></code> plot of a scalar field.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#discretisedfield.Field.k3d_vector" title="discretisedfield.Field.k3d_vector"><code class="xref py py-obj docutils literal notranslate"><span class="pre">k3d_vector</span></code></a></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">k3d</span></code> plot of a vector field.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#discretisedfield.Field.line" title="discretisedfield.Field.line"><code class="xref py py-obj docutils literal notranslate"><span class="pre">line</span></code></a></p></td>
<td><p>Sampling the field along the line.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#discretisedfield.Field.mpl" title="discretisedfield.Field.mpl"><code class="xref py py-obj docutils literal notranslate"><span class="pre">mpl</span></code></a></p></td>
<td><p>Plots the field on a plane.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#discretisedfield.Field.mpl_scalar" title="discretisedfield.Field.mpl_scalar"><code class="xref py py-obj docutils literal notranslate"><span class="pre">mpl_scalar</span></code></a></p></td>
<td><p>Plots the scalar field on a plane.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#discretisedfield.Field.mpl_vector" title="discretisedfield.Field.mpl_vector"><code class="xref py py-obj docutils literal notranslate"><span class="pre">mpl_vector</span></code></a></p></td>
<td><p>Plots the vector field on a plane.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#discretisedfield.Field.pad" title="discretisedfield.Field.pad"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pad</span></code></a></p></td>
<td><p>Field padding.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#discretisedfield.Field.plane" title="discretisedfield.Field.plane"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plane</span></code></a></p></td>
<td><p>Extracts field on the plane mesh.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#discretisedfield.Field.project" title="discretisedfield.Field.project"><code class="xref py py-obj docutils literal notranslate"><span class="pre">project</span></code></a></p></td>
<td><p>Projects the field along one direction and averages it out along that direction.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#discretisedfield.Field.write" title="discretisedfield.Field.write"><code class="xref py py-obj docutils literal notranslate"><span class="pre">write</span></code></a></p></td>
<td><p>Write the field to OVF, HDF5, or VTK file.</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Properties</p>
<table class="longtable table autosummary">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#discretisedfield.Field.angle" title="discretisedfield.Field.angle"><code class="xref py py-obj docutils literal notranslate"><span class="pre">angle</span></code></a></p></td>
<td><p>In-plane angle of the vector field.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#discretisedfield.Field.array" title="discretisedfield.Field.array"><code class="xref py py-obj docutils literal notranslate"><span class="pre">array</span></code></a></p></td>
<td><p>Field value as <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#discretisedfield.Field.average" title="discretisedfield.Field.average"><code class="xref py py-obj docutils literal notranslate"><span class="pre">average</span></code></a></p></td>
<td><p>Field average.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#discretisedfield.Field.curl" title="discretisedfield.Field.curl"><code class="xref py py-obj docutils literal notranslate"><span class="pre">curl</span></code></a></p></td>
<td><p>Curl.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">dim</span></code></p></td>
<td><p>Descriptor allowing setting attributes only with scalars (<code class="docutils literal notranslate"><span class="pre">numbers.Real</span></code>).</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#discretisedfield.Field.div" title="discretisedfield.Field.div"><code class="xref py py-obj docutils literal notranslate"><span class="pre">div</span></code></a></p></td>
<td><p>Divergence.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#discretisedfield.Field.grad" title="discretisedfield.Field.grad"><code class="xref py py-obj docutils literal notranslate"><span class="pre">grad</span></code></a></p></td>
<td><p>Gradient.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#discretisedfield.Field.laplace" title="discretisedfield.Field.laplace"><code class="xref py py-obj docutils literal notranslate"><span class="pre">laplace</span></code></a></p></td>
<td><p>Laplace operator.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">mesh</span></code></p></td>
<td><p>Descriptor allowing setting attributes only with values of a certain type.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#discretisedfield.Field.norm" title="discretisedfield.Field.norm"><code class="xref py py-obj docutils literal notranslate"><span class="pre">norm</span></code></a></p></td>
<td><p>Norm of the field.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#discretisedfield.Field.orientation" title="discretisedfield.Field.orientation"><code class="xref py py-obj docutils literal notranslate"><span class="pre">orientation</span></code></a></p></td>
<td><p>Orientation field.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#discretisedfield.Field.value" title="discretisedfield.Field.value"><code class="xref py py-obj docutils literal notranslate"><span class="pre">value</span></code></a></p></td>
<td><p>Field value representation.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#discretisedfield.Field.zero" title="discretisedfield.Field.zero"><code class="xref py py-obj docutils literal notranslate"><span class="pre">zero</span></code></a></p></td>
<td><p>Zero field.</p></td>
</tr>
</tbody>
</table>
<hr><dl class="py method">
<dt class="sig sig-object py" id="discretisedfield.Field.__abs__">
<span class="sig-name descname"><span class="pre">__abs__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discretisedfield.Field.__abs__" title="Permalink to this definition">¶</a></dt>
<dd><p>Field norm.</p>
<p>This is a convenience operator and it returns
<code class="docutils literal notranslate"><span class="pre">discretisedfield.Field.norm</span></code>. For details, please refer to
<code class="docutils literal notranslate"><span class="pre">discretisedfield.Field.norm</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Norm of the field if <code class="docutils literal notranslate"><span class="pre">dim&gt;1</span></code> or absolute value for <code class="docutils literal notranslate"><span class="pre">dim=1</span></code>.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="#discretisedfield.Field" title="discretisedfield.Field">discretisedfield.Field</a></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<ol class="arabic simple">
<li><p>Computing the absolute value of a scalar field.</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">discretisedfield</span> <span class="k">as</span> <span class="nn">df</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">13</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cell</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Mesh</span><span class="p">(</span><span class="n">region</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">Region</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="n">p2</span><span class="p">),</span> <span class="n">cell</span><span class="o">=</span><span class="n">cell</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="o">=</span><span class="n">mesh</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">value</span><span class="o">=-</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">abs</span><span class="p">(</span><span class="n">field</span><span class="p">)</span><span class="o">.</span><span class="n">average</span>
<span class="go">5.0</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#discretisedfield.Field.norm" title="discretisedfield.Field.norm"><code class="xref py py-func docutils literal notranslate"><span class="pre">norm()</span></code></a></p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="discretisedfield.Field.__add__">
<span class="sig-name descname"><span class="pre">__add__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#discretisedfield.Field.__add__" title="Permalink to this definition">¶</a></dt>
<dd><p>Binary <code class="docutils literal notranslate"><span class="pre">+</span></code> operator.</p>
<p>It can be applied between two <code class="docutils literal notranslate"><span class="pre">discretisedfield.Field</span></code> objects or
between a <code class="docutils literal notranslate"><span class="pre">discretisedfield.Field</span></code> object and a “constant”. For
instance if the field is a scalar field, a scalar field or
<code class="docutils literal notranslate"><span class="pre">numbers.Real</span></code> can be the second operand. Similarly, for a vector
field, either vector field or an iterable, such as <code class="docutils literal notranslate"><span class="pre">tuple</span></code>, <code class="docutils literal notranslate"><span class="pre">list</span></code>,
or <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>, can be the second operand. If the second operand
is a <code class="docutils literal notranslate"><span class="pre">discretisedfield.Field</span></code> object, both must be defined on the
same mesh and have the same dimensions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>other</strong> (<a class="reference internal" href="#discretisedfield.Field" title="discretisedfield.Field"><em>discretisedfield.Field</em></a><em>, </em><em>numbers.Real</em><em>, </em><em>tuple</em><em>, </em><em>list</em><em>, </em><em>np.ndarray</em>) – Second operand.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Resulting field.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#discretisedfield.Field" title="discretisedfield.Field">discretisedfield.Field</a></p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong><strong>, </strong><strong>TypeError</strong> – If the operator cannot be applied.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<ol class="arabic simple">
<li><p>Add vector fields.</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">discretisedfield</span> <span class="k">as</span> <span class="nn">df</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cell</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Mesh</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="n">p2</span><span class="p">,</span> <span class="n">cell</span><span class="o">=</span><span class="n">cell</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f1</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f2</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">3.1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="n">f1</span> <span class="o">+</span> <span class="n">f2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="o">.</span><span class="n">average</span>
<span class="go">(0.0, 0.0, 0.0)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f1</span> <span class="o">+</span> <span class="n">f2</span> <span class="o">==</span> <span class="n">f2</span> <span class="o">+</span> <span class="n">f1</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="n">f1</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">3.1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="o">.</span><span class="n">average</span>
<span class="go">(1.0, 1.0, 0.0)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f1</span> <span class="o">+</span> <span class="mi">5</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">...</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#discretisedfield.Field.__sub__" title="discretisedfield.Field.__sub__"><code class="xref py py-func docutils literal notranslate"><span class="pre">__sub__()</span></code></a></p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="discretisedfield.Field.__and__">
<span class="sig-name descname"><span class="pre">__and__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#discretisedfield.Field.__and__" title="Permalink to this definition">¶</a></dt>
<dd><p>Binary <code class="docutils literal notranslate"><span class="pre">&amp;</span></code> operator, defined as cross product.</p>
<p>This method computes the cross product between two fields. Both fields
must be three-dimensional (<code class="docutils literal notranslate"><span class="pre">dim=3</span></code>) and defined on the same mesh.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>other</strong> (<a class="reference internal" href="#discretisedfield.Field" title="discretisedfield.Field"><em>discretisedfield.Field</em></a><em>, </em><em>tuple</em><em>, </em><em>list</em><em>, </em><em>numpy.ndarray</em>) – Second operand.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Resulting field.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#discretisedfield.Field" title="discretisedfield.Field">discretisedfield.Field</a></p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong><strong>, </strong><strong>TypeError</strong> – If the operator cannot be applied.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<ol class="arabic simple">
<li><p>Compute the cross product of two vector fields.</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">discretisedfield</span> <span class="k">as</span> <span class="nn">df</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cell</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Mesh</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="n">p2</span><span class="p">,</span> <span class="n">cell</span><span class="o">=</span><span class="n">cell</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f1</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f2</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">f1</span> <span class="o">&amp;</span> <span class="n">f2</span><span class="p">)</span><span class="o">.</span><span class="n">average</span>
<span class="go">(0.0, 0.0, 1.0)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">f1</span> <span class="o">&amp;</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">average</span>
<span class="go">(0.0, -1.0, 0.0)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="discretisedfield.Field.__call__">
<span class="sig-name descname"><span class="pre">__call__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">point</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#discretisedfield.Field.__call__" title="Permalink to this definition">¶</a></dt>
<dd><p>Sample the field value at <code class="docutils literal notranslate"><span class="pre">point</span></code>.</p>
<p>It returns the value of the field in the discretisation cell to which
<code class="docutils literal notranslate"><span class="pre">point</span></code> belongs to. It returns a tuple, whose length is the same as
the dimension (<code class="docutils literal notranslate"><span class="pre">dim</span></code>) of the field.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>point</strong> (<em>(</em><em>3</em><em>,</em><em>) </em><em>array_like</em>) – The mesh point coordinate <span class="math notranslate nohighlight">\(\mathbf{p} = (p_{x}, p_{y},
p_{z})\)</span>.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A tuple, whose length is the same as the dimension of the field.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
<p class="rubric">Example</p>
<ol class="arabic simple">
<li><p>Sampling the field value.</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">discretisedfield</span> <span class="k">as</span> <span class="nn">df</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n</span> <span class="o">=</span> <span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Mesh</span><span class="p">(</span><span class="n">region</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">Region</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="n">p2</span><span class="p">),</span> <span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">point</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span><span class="p">(</span><span class="n">point</span><span class="p">)</span>
<span class="go">(1.0, 3.0, 4.0)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="discretisedfield.Field.__dir__">
<span class="sig-name descname"><span class="pre">__dir__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discretisedfield.Field.__dir__" title="Permalink to this definition">¶</a></dt>
<dd><p>Extension of the <code class="docutils literal notranslate"><span class="pre">dir(self)</span></code> list.</p>
<p>Adds <code class="docutils literal notranslate"><span class="pre">'x'</span></code>, <code class="docutils literal notranslate"><span class="pre">'y'</span></code>, or <code class="docutils literal notranslate"><span class="pre">'z'</span></code>, depending on the dimension of the
field, to the <code class="docutils literal notranslate"><span class="pre">dir(self)</span></code> list. Similarly, adds or removes methods
(<code class="docutils literal notranslate"><span class="pre">grad</span></code>, <code class="docutils literal notranslate"><span class="pre">div</span></code>,…) depending on the dimension of the field.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Avalilable attributes.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="discretisedfield.Field.__eq__">
<span class="sig-name descname"><span class="pre">__eq__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#discretisedfield.Field.__eq__" title="Permalink to this definition">¶</a></dt>
<dd><p>Relational operator <code class="docutils literal notranslate"><span class="pre">==</span></code>.</p>
<p>Two fields are considered to be equal if:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>They are defined on the same mesh.</p></li>
<li><p>They have the same dimension (<code class="docutils literal notranslate"><span class="pre">dim</span></code>).</p></li>
<li><p>They both contain the same values in <code class="docutils literal notranslate"><span class="pre">array</span></code>.</p></li>
</ol>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>other</strong> (<a class="reference internal" href="#discretisedfield.Field" title="discretisedfield.Field"><em>discretisedfield.Field</em></a>) – Second operand.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">True</span></code> if two fields are equal, <code class="docutils literal notranslate"><span class="pre">False</span></code> otherwise.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<ol class="arabic simple">
<li><p>Check if two fields are (not) equal.</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">discretisedfield</span> <span class="k">as</span> <span class="nn">df</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Mesh</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">p2</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">cell</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f1</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f2</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">4</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f3</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f1</span> <span class="o">==</span> <span class="n">f2</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f1</span> <span class="o">!=</span> <span class="n">f2</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f1</span> <span class="o">==</span> <span class="n">f3</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f1</span> <span class="o">!=</span> <span class="n">f3</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f2</span> <span class="o">==</span> <span class="n">f3</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f1</span> <span class="o">==</span> <span class="s1">&#39;a&#39;</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="discretisedfield.Field.__getattr__">
<span class="sig-name descname"><span class="pre">__getattr__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">attr</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#discretisedfield.Field.__getattr__" title="Permalink to this definition">¶</a></dt>
<dd><p>Extracting the component of the vector field.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">'x'</span></code>, <code class="docutils literal notranslate"><span class="pre">'y'</span></code>, or <code class="docutils literal notranslate"><span class="pre">'z'</span></code> is accessed, a scalar field of that
component will be returned. This method is effective for vector fields
with dimension 2 or 3 only.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>attr</strong> (<em>str</em>) – Vector field component (<code class="docutils literal notranslate"><span class="pre">'x'</span></code>, <code class="docutils literal notranslate"><span class="pre">'y'</span></code>, or <code class="docutils literal notranslate"><span class="pre">'z'</span></code>)</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Scalar field with vector field component values.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#discretisedfield.Field" title="discretisedfield.Field">discretisedfield.Field</a></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<ol class="arabic simple">
<li><p>Accessing the vector field components.</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">discretisedfield</span> <span class="k">as</span> <span class="nn">df</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cell</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Mesh</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="n">p2</span><span class="p">,</span> <span class="n">cell</span><span class="o">=</span><span class="n">cell</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="o">=</span><span class="n">mesh</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span><span class="o">.</span><span class="n">x</span>
<span class="go">Field(...)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span><span class="o">.</span><span class="n">x</span><span class="o">.</span><span class="n">average</span>
<span class="go">0.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span><span class="o">.</span><span class="n">y</span>
<span class="go">Field(...)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span><span class="o">.</span><span class="n">y</span><span class="o">.</span><span class="n">average</span>
<span class="go">0.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span><span class="o">.</span><span class="n">z</span>
<span class="go">Field(...)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span><span class="o">.</span><span class="n">z</span><span class="o">.</span><span class="n">average</span>
<span class="go">1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span><span class="o">.</span><span class="n">z</span><span class="o">.</span><span class="n">dim</span>
<span class="go">1</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="discretisedfield.Field.__getitem__">
<span class="sig-name descname"><span class="pre">__getitem__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">item</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#discretisedfield.Field.__getitem__" title="Permalink to this definition">¶</a></dt>
<dd><p>Extracts the field on a subregion.</p>
<p>If subregions were defined by passing <code class="docutils literal notranslate"><span class="pre">subregions</span></code> dictionary when
the mesh was created, this method returns a field in a subregion
<code class="docutils literal notranslate"><span class="pre">subregions[item]</span></code>. Alternatively, a <code class="docutils literal notranslate"><span class="pre">discretisedfield.Region</span></code>
object can be passed and a minimum-sized field containing it will be
returned. The resulting mesh has the same discretisation cell as the
original field’s mesh.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>item</strong> (<em>str</em><em>, </em><a class="reference internal" href="discretisedfield.Region.html#discretisedfield.Region" title="discretisedfield.Region"><em>discretisedfield.Region</em></a>) – The key of a subregion in <code class="docutils literal notranslate"><span class="pre">subregions</span></code> dictionary or a region
object.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Field on a subregion.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>disretisedfield.Field</p>
</dd>
</dl>
<p class="rubric">Example</p>
<ol class="arabic simple">
<li><p>Extract field on the subregion by passing a key.</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">discretisedfield</span> <span class="k">as</span> <span class="nn">df</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cell</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">subregions</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;r1&#39;</span><span class="p">:</span> <span class="n">df</span><span class="o">.</span><span class="n">Region</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">p2</span><span class="o">=</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">)),</span>
<span class="gp">... </span>              <span class="s1">&#39;r2&#39;</span><span class="p">:</span> <span class="n">df</span><span class="o">.</span><span class="n">Region</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">p2</span><span class="o">=</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">))}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Mesh</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="n">p2</span><span class="p">,</span> <span class="n">cell</span><span class="o">=</span><span class="n">cell</span><span class="p">,</span> <span class="n">subregions</span><span class="o">=</span><span class="n">subregions</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">value_fun</span><span class="p">(</span><span class="n">point</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="n">point</span>
<span class="gp">... </span>    <span class="k">if</span> <span class="n">x</span> <span class="o">&lt;=</span> <span class="mi">50</span><span class="p">:</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">... </span>    <span class="k">else</span><span class="p">:</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">value_fun</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">average</span>
<span class="go">(0.0, 0.0, 0.0)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="p">[</span><span class="s1">&#39;r1&#39;</span><span class="p">]</span>
<span class="go">Field(...)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="p">[</span><span class="s1">&#39;r1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">average</span>
<span class="go">(1.0, 2.0, 3.0)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="p">[</span><span class="s1">&#39;r2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">average</span>
<span class="go">(-1.0, -2.0, -3.0)</span>
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>Extracting a subfield by passing a region.</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">discretisedfield</span> <span class="k">as</span> <span class="nn">df</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p1</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mf">50e-9</span><span class="p">,</span> <span class="o">-</span><span class="mf">25e-9</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p2</span> <span class="o">=</span> <span class="p">(</span><span class="mf">50e-9</span><span class="p">,</span> <span class="mf">25e-9</span><span class="p">,</span> <span class="mf">5e-9</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cell</span> <span class="o">=</span> <span class="p">(</span><span class="mf">5e-9</span><span class="p">,</span> <span class="mf">5e-9</span><span class="p">,</span> <span class="mf">5e-9</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">region</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Region</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="n">p2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Mesh</span><span class="p">(</span><span class="n">region</span><span class="o">=</span><span class="n">region</span><span class="p">,</span> <span class="n">cell</span><span class="o">=</span><span class="n">cell</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="o">=</span><span class="n">mesh</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">subregion</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Region</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mf">9e-9</span><span class="p">,</span> <span class="o">-</span><span class="mf">1e-9</span><span class="p">,</span> <span class="mf">1e-9</span><span class="p">),</span>
<span class="gp">... </span>                      <span class="n">p2</span><span class="o">=</span><span class="p">(</span><span class="mf">9e-9</span><span class="p">,</span> <span class="mf">14e-9</span><span class="p">,</span> <span class="mf">4e-9</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">subfield</span> <span class="o">=</span> <span class="n">field</span><span class="p">[</span><span class="n">subregion</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">subfield</span><span class="o">.</span><span class="n">array</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(4, 4, 1, 1)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="discretisedfield.Field.__iter__">
<span class="sig-name descname"><span class="pre">__iter__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discretisedfield.Field.__iter__" title="Permalink to this definition">¶</a></dt>
<dd><p>Generator yielding coordinates and values of all mesh discretisation
cells.</p>
<dl class="field-list simple">
<dt class="field-odd">Yields</dt>
<dd class="field-odd"><p><em>tuple (2,)</em> – The first value is the mesh cell coordinates <span class="math notranslate nohighlight">\(\mathbf{p} =
(p_{x}, p_{y}, p_{z})\)</span>, whereas the second one is the field value.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<ol class="arabic simple">
<li><p>Iterating through the field coordinates and values</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">discretisedfield</span> <span class="k">as</span> <span class="nn">df</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cell</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Mesh</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="n">p2</span><span class="p">,</span> <span class="n">cell</span><span class="o">=</span><span class="n">cell</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">coord</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">field</span><span class="p">:</span>
<span class="gp">... </span>    <span class="nb">print</span> <span class="p">(</span><span class="n">coord</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
<span class="go">(0.5, 0.5, 0.5) (0.0, 0.0, 1.0)</span>
<span class="go">(1.5, 0.5, 0.5) (0.0, 0.0, 1.0)</span>
<span class="go">(0.5, 1.5, 0.5) (0.0, 0.0, 1.0)</span>
<span class="go">(1.5, 1.5, 0.5) (0.0, 0.0, 1.0)</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="discretisedfield.Mesh.html#discretisedfield.Mesh.indices" title="discretisedfield.Mesh.indices"><code class="xref py py-func docutils literal notranslate"><span class="pre">indices()</span></code></a></p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="discretisedfield.Field.__lshift__">
<span class="sig-name descname"><span class="pre">__lshift__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#discretisedfield.Field.__lshift__" title="Permalink to this definition">¶</a></dt>
<dd><p>Stacks multiple scalar fields in a single vector field.</p>
<p>This method takes a list of scalar (<code class="docutils literal notranslate"><span class="pre">dim=1</span></code>) fields and returns a
vector field, whose components are defined by the scalar fields passed.
If any of the fields passed has <code class="docutils literal notranslate"><span class="pre">dim!=1</span></code> or they are not defined on
the same mesh, an exception is raised. The dimension of the resulting
field is equal to the length of the passed list.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>fields</strong> (<em>list</em>) – List of <code class="docutils literal notranslate"><span class="pre">discretisedfield.Field</span></code> objects with <code class="docutils literal notranslate"><span class="pre">dim=1</span></code>.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Resulting field.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>disrectisedfield.Field</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the dimension of any of the fields is not 1, or the fields
    passed are not defined on the same mesh.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<ol class="arabic simple">
<li><p>Stack 3 scalar fields.</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">discretisedfield</span> <span class="k">as</span> <span class="nn">df</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cell</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Mesh</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="n">p2</span><span class="p">,</span> <span class="n">cell</span><span class="o">=</span><span class="n">cell</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f1</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f2</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f3</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">value</span><span class="o">=-</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">f1</span> <span class="o">&lt;&lt;</span> <span class="n">f2</span> <span class="o">&lt;&lt;</span> <span class="n">f3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">average</span>
<span class="go">(1.0, 5.0, -3.0)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">dim</span>
<span class="go">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">x</span> <span class="o">==</span> <span class="n">f1</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">y</span> <span class="o">==</span> <span class="n">f2</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">z</span> <span class="o">==</span> <span class="n">f3</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="discretisedfield.Field.__matmul__">
<span class="sig-name descname"><span class="pre">__matmul__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#discretisedfield.Field.__matmul__" title="Permalink to this definition">¶</a></dt>
<dd><p>Binary <code class="docutils literal notranslate"><span class="pre">&#64;</span></code> operator, defined as dot product.</p>
<p>This method computes the dot product between two fields. Both fields
must be three-dimensional (<code class="docutils literal notranslate"><span class="pre">dim=3</span></code>) and defined on the same mesh.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>other</strong> (<a class="reference internal" href="#discretisedfield.Field" title="discretisedfield.Field"><em>discretisedfield.Field</em></a>) – Second operand.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Resulting field.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#discretisedfield.Field" title="discretisedfield.Field">discretisedfield.Field</a></p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong><strong>, </strong><strong>TypeError</strong> – If the operator cannot be applied.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<ol class="arabic simple">
<li><p>Compute the dot product of two vector fields.</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">discretisedfield</span> <span class="k">as</span> <span class="nn">df</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p2</span> <span class="o">=</span> <span class="p">(</span><span class="mf">10e-9</span><span class="p">,</span> <span class="mf">10e-9</span><span class="p">,</span> <span class="mf">10e-9</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cell</span> <span class="o">=</span> <span class="p">(</span><span class="mf">2e-9</span><span class="p">,</span> <span class="mf">2e-9</span><span class="p">,</span> <span class="mf">2e-9</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Mesh</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="n">p2</span><span class="p">,</span> <span class="n">cell</span><span class="o">=</span><span class="n">cell</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f1</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f2</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">f1</span><span class="nd">@f2</span><span class="p">)</span><span class="o">.</span><span class="n">average</span>
<span class="go">5.0</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="discretisedfield.Field.__mul__">
<span class="sig-name descname"><span class="pre">__mul__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#discretisedfield.Field.__mul__" title="Permalink to this definition">¶</a></dt>
<dd><p>Binary <code class="docutils literal notranslate"><span class="pre">*</span></code> operator.</p>
<p>It can be applied between:</p>
<ol class="arabic simple">
<li><p>Two scalar (<code class="docutils literal notranslate"><span class="pre">dim=1</span></code>) fields,</p></li>
<li><p>A field of any dimension and <code class="docutils literal notranslate"><span class="pre">numbers.Real</span></code>,</p></li>
<li><p>A field of any dimension and a scalar (<code class="docutils literal notranslate"><span class="pre">dim=1</span></code>) field, or</p></li>
<li><p>A field and an “abstract” integration variable (e.g. <code class="docutils literal notranslate"><span class="pre">df.dV</span></code>)</p></li>
</ol>
<p>If both operands are <code class="docutils literal notranslate"><span class="pre">discretisedfield.Field</span></code> objects, they must be
defined on the same mesh.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>other</strong> (<a class="reference internal" href="#discretisedfield.Field" title="discretisedfield.Field"><em>discretisedfield.Field</em></a><em>, </em><em>numbers.Real</em>) – Second operand.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Resulting field.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#discretisedfield.Field" title="discretisedfield.Field">discretisedfield.Field</a></p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong><strong>, </strong><strong>TypeError</strong> – If the operator cannot be applied.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<ol class="arabic simple">
<li><p>Multiply two scalar fields.</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">discretisedfield</span> <span class="k">as</span> <span class="nn">df</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cell</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Mesh</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="n">p2</span><span class="p">,</span> <span class="n">cell</span><span class="o">=</span><span class="n">cell</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f1</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f2</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="n">f1</span> <span class="o">*</span> <span class="n">f2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="o">.</span><span class="n">average</span>
<span class="go">45.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f1</span> <span class="o">*</span> <span class="n">f2</span> <span class="o">==</span> <span class="n">f2</span> <span class="o">*</span> <span class="n">f1</span>
<span class="go">True</span>
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>Multiply vector field with a scalar.</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">f1</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="n">f1</span> <span class="o">*</span> <span class="mi">5</span>  <span class="c1"># discretisedfield.Field.__mul__ is called</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="o">.</span><span class="n">average</span>
<span class="go">(0.0, 10.0, 25.0)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">f1</span>  <span class="c1"># discretisedfield.Field.__rmul__ is called</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="o">.</span><span class="n">average</span>
<span class="go">(0.0, 20.0, 50.0)</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#discretisedfield.Field.__truediv__" title="discretisedfield.Field.__truediv__"><code class="xref py py-func docutils literal notranslate"><span class="pre">__truediv__()</span></code></a></p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="discretisedfield.Field.__neg__">
<span class="sig-name descname"><span class="pre">__neg__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discretisedfield.Field.__neg__" title="Permalink to this definition">¶</a></dt>
<dd><p>Unary <code class="docutils literal notranslate"><span class="pre">-</span></code> operator.</p>
<p>This method negates the value of each discretisation cell. It is
equivalent to multiplication with -1:</p>
<div class="math notranslate nohighlight">
\[-f(x, y, z) = -1 \cdot f(x, y, z)\]</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Field multiplied with -1.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="#discretisedfield.Field" title="discretisedfield.Field">discretisedfield.Field</a></p>
</dd>
</dl>
<p class="rubric">Example</p>
<ol class="arabic simple">
<li><p>Applying unary <code class="docutils literal notranslate"><span class="pre">-</span></code> operator on a scalar field.</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">discretisedfield</span> <span class="k">as</span> <span class="nn">df</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p2</span> <span class="o">=</span> <span class="p">(</span><span class="mf">5e-9</span><span class="p">,</span> <span class="mf">3e-9</span><span class="p">,</span> <span class="mf">1e-9</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Mesh</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="n">p2</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mf">3.1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="o">-</span><span class="n">f</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="o">.</span><span class="n">average</span>
<span class="go">-3.1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">==</span> <span class="o">-</span><span class="p">(</span><span class="o">-</span><span class="n">f</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>Applying unary negation operator on a vector field.</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1000</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="o">-</span><span class="n">f</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="o">.</span><span class="n">average</span>
<span class="go">(0.0, 1000.0, 3.0)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="discretisedfield.Field.__pos__">
<span class="sig-name descname"><span class="pre">__pos__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discretisedfield.Field.__pos__" title="Permalink to this definition">¶</a></dt>
<dd><p>Unary <code class="docutils literal notranslate"><span class="pre">+</span></code> operator.</p>
<p>This method defines the unary operator <code class="docutils literal notranslate"><span class="pre">+</span></code>. It returns the field
itself:</p>
<div class="math notranslate nohighlight">
\[+f(x, y, z) = f(x, y, z)\]</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Field itself.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="#discretisedfield.Field" title="discretisedfield.Field">discretisedfield.Field</a></p>
</dd>
</dl>
<p class="rubric">Example</p>
<ol class="arabic simple">
<li><p>Applying unary <code class="docutils literal notranslate"><span class="pre">+</span></code> operator on a field.</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">discretisedfield</span> <span class="k">as</span> <span class="nn">df</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p2</span> <span class="o">=</span> <span class="p">(</span><span class="mf">5e-9</span><span class="p">,</span> <span class="mf">5e-9</span><span class="p">,</span> <span class="mf">5e-9</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Mesh</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="n">p2</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1000</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="o">+</span><span class="n">f</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="o">.</span><span class="n">average</span>
<span class="go">(0.0, -1000.0, -3.0)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">==</span> <span class="n">f</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="o">+</span><span class="p">(</span><span class="o">+</span><span class="n">f</span><span class="p">)</span> <span class="o">==</span> <span class="n">f</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="discretisedfield.Field.__pow__">
<span class="sig-name descname"><span class="pre">__pow__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#discretisedfield.Field.__pow__" title="Permalink to this definition">¶</a></dt>
<dd><p>Unary <code class="docutils literal notranslate"><span class="pre">**</span></code> operator.</p>
<p>This method defines the <code class="docutils literal notranslate"><span class="pre">**</span></code> operator for scalar (<code class="docutils literal notranslate"><span class="pre">dim=1</span></code>) fields
only. This operator is not defined for vector (<code class="docutils literal notranslate"><span class="pre">dim&gt;1</span></code>) fields, and
<code class="docutils literal notranslate"><span class="pre">ValueError</span></code> is raised.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>other</strong> (<em>numbers.Real</em>) – Value to which the field is raised.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Resulting field.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#discretisedfield.Field" title="discretisedfield.Field">discretisedfield.Field</a></p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong><strong>, </strong><strong>TypeError</strong> – If the operator cannot be applied.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<ol class="arabic simple">
<li><p>Applying unary <code class="docutils literal notranslate"><span class="pre">**</span></code> operator on a scalar field.</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">discretisedfield</span> <span class="k">as</span> <span class="nn">df</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p1</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mf">25e-3</span><span class="p">,</span> <span class="o">-</span><span class="mf">25e-3</span><span class="p">,</span> <span class="o">-</span><span class="mf">25e-3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p2</span> <span class="o">=</span> <span class="p">(</span><span class="mf">25e-3</span><span class="p">,</span> <span class="mf">25e-3</span><span class="p">,</span> <span class="mf">25e-3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Mesh</span><span class="p">(</span><span class="n">region</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">Region</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="n">p2</span><span class="p">),</span> <span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="n">f</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span>
<span class="go">Field(...)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="o">.</span><span class="n">average</span>
<span class="go">0.5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="n">f</span><span class="o">**</span><span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="o">.</span><span class="n">average</span>
<span class="go">4.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">**</span><span class="n">f</span>  <span class="c1"># the power must be numbers.Real</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">...</span>
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>Attempt to apply power operator on a vector field.</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">p1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p2</span> <span class="o">=</span> <span class="p">(</span><span class="mf">5e-9</span><span class="p">,</span> <span class="mf">5e-9</span><span class="p">,</span> <span class="mf">5e-9</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Mesh</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="n">p2</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">**</span><span class="mi">2</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">...</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="discretisedfield.Field.__repr__">
<span class="sig-name descname"><span class="pre">__repr__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discretisedfield.Field.__repr__" title="Permalink to this definition">¶</a></dt>
<dd><p>Representation string.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Representation string.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>str</p>
</dd>
</dl>
<p class="rubric">Example</p>
<ol class="arabic simple">
<li><p>Getting representation string.</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">discretisedfield</span> <span class="k">as</span> <span class="nn">df</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cell</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Mesh</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="n">p2</span><span class="p">,</span> <span class="n">cell</span><span class="o">=</span><span class="n">cell</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">repr</span><span class="p">(</span><span class="n">field</span><span class="p">)</span>
<span class="go">&quot;Field(mesh=..., dim=1)&quot;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="discretisedfield.Field.__sub__">
<span class="sig-name descname"><span class="pre">__sub__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#discretisedfield.Field.__sub__" title="Permalink to this definition">¶</a></dt>
<dd><p>Binary <code class="docutils literal notranslate"><span class="pre">-</span></code> operator.</p>
<p>It can be applied between two <code class="docutils literal notranslate"><span class="pre">discretisedfield.Field</span></code> objects or
between a <code class="docutils literal notranslate"><span class="pre">discretisedfield.Field</span></code> object and a “constant”. For
instance if the field is a scalar field, a scalar field or
<code class="docutils literal notranslate"><span class="pre">numbers.Real</span></code> can be the second operand. Similarly, for a vector
field, either vector field or an iterable, such as <code class="docutils literal notranslate"><span class="pre">tuple</span></code>, <code class="docutils literal notranslate"><span class="pre">list</span></code>,
or <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>, can be the second operand. If the second operand
is a <code class="docutils literal notranslate"><span class="pre">discretisedfield.Field</span></code> object, both must be defined on the
same mesh and have the same dimensions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>other</strong> (<a class="reference internal" href="#discretisedfield.Field" title="discretisedfield.Field"><em>discretisedfield.Field</em></a><em>, </em><em>numbers.Real</em><em>, </em><em>tuple</em><em>, </em><em>list</em><em>, </em><em>np.ndarray</em>) – Second operand.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Resulting field.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#discretisedfield.Field" title="discretisedfield.Field">discretisedfield.Field</a></p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong><strong>, </strong><strong>TypeError</strong> – If the operator cannot be applied.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<ol class="arabic simple">
<li><p>Subtract vector fields.</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">discretisedfield</span> <span class="k">as</span> <span class="nn">df</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cell</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Mesh</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="n">p2</span><span class="p">,</span> <span class="n">cell</span><span class="o">=</span><span class="n">cell</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f1</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f2</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="n">f1</span> <span class="o">-</span> <span class="n">f2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="o">.</span><span class="n">average</span>
<span class="go">(0.0, 0.0, 3.0)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f1</span> <span class="o">-</span> <span class="n">f2</span> <span class="o">==</span> <span class="o">-</span><span class="p">(</span><span class="n">f2</span> <span class="o">-</span> <span class="n">f1</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="n">f1</span> <span class="o">-</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="o">.</span><span class="n">average</span>
<span class="go">(0.0, 0.0, 6.0)</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#discretisedfield.Field.__add__" title="discretisedfield.Field.__add__"><code class="xref py py-func docutils literal notranslate"><span class="pre">__add__()</span></code></a></p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="discretisedfield.Field.__truediv__">
<span class="sig-name descname"><span class="pre">__truediv__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#discretisedfield.Field.__truediv__" title="Permalink to this definition">¶</a></dt>
<dd><p>Binary <code class="docutils literal notranslate"><span class="pre">/</span></code> operator.</p>
<p>It can be applied between:</p>
<ol class="arabic simple">
<li><p>Two scalar (<code class="docutils literal notranslate"><span class="pre">dim=1</span></code>) fields,</p></li>
<li><p>A field of any dimension and <code class="docutils literal notranslate"><span class="pre">numbers.Real</span></code>, or</p></li>
<li><p>A field of any dimension and a scalar (<code class="docutils literal notranslate"><span class="pre">dim=1</span></code>) field.</p></li>
</ol>
<p>If both operands are <code class="docutils literal notranslate"><span class="pre">discretisedfield.Field</span></code> objects, they must be
defined on the same mesh.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>other</strong> (<a class="reference internal" href="#discretisedfield.Field" title="discretisedfield.Field"><em>discretisedfield.Field</em></a><em>, </em><em>numbers.Real</em>) – Second operand.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Resulting field.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#discretisedfield.Field" title="discretisedfield.Field">discretisedfield.Field</a></p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong><strong>, </strong><strong>TypeError</strong> – If the operator cannot be applied.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<ol class="arabic simple">
<li><p>Divide two scalar fields.</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">discretisedfield</span> <span class="k">as</span> <span class="nn">df</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cell</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Mesh</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="n">p2</span><span class="p">,</span> <span class="n">cell</span><span class="o">=</span><span class="n">cell</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f1</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f2</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="n">f1</span> <span class="o">/</span> <span class="n">f2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="o">.</span><span class="n">average</span>
<span class="go">5.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f1</span> <span class="o">/</span> <span class="n">f2</span> <span class="o">==</span> <span class="p">(</span><span class="n">f2</span> <span class="o">/</span> <span class="n">f1</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>Divide vector field by a scalar.</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">f1</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="n">f1</span> <span class="o">/</span> <span class="mi">5</span>  <span class="c1"># discretisedfield.Field.__mul__ is called</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="o">.</span><span class="n">average</span>
<span class="go">(0.0, 2.0, 1.0)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="mi">10</span> <span class="o">/</span> <span class="n">f1</span>  <span class="c1"># division by a vector is not allowed</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">...</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#discretisedfield.Field.__mul__" title="discretisedfield.Field.__mul__"><code class="xref py py-func docutils literal notranslate"><span class="pre">__mul__()</span></code></a></p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="discretisedfield.Field.allclose">
<span class="sig-name descname"><span class="pre">allclose</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rtol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#discretisedfield.Field.allclose" title="Permalink to this definition">¶</a></dt>
<dd><p>Allclose method.</p>
<p>This method determines whether two fields are:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>Defined on the same mesh.</p></li>
<li><p>Have the same dimension (<code class="docutils literal notranslate"><span class="pre">dim</span></code>).</p></li>
</ol>
<p>3. All values in are within relative (<code class="docutils literal notranslate"><span class="pre">rtol</span></code>) and absolute
(<code class="docutils literal notranslate"><span class="pre">atol</span></code>) tolerances.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>other</strong> (<a class="reference internal" href="#discretisedfield.Field" title="discretisedfield.Field"><em>discretisedfield.Field</em></a>) – Field to be compared to.</p></li>
<li><p><strong>rtol</strong> (<em>numbers.Real</em>) – Relative tolerance. Defaults to 1e-5.</p></li>
<li><p><strong>atol</strong> (<em>numbers.Real</em>) – Absolute tolerance. Defaults to 1e-8.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">True</span></code> if two fields are within tolerance, <code class="docutils literal notranslate"><span class="pre">False</span></code> otherwise.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>bool</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>TypeError</strong> – If a non field object is passed.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<ol class="arabic simple">
<li><p>Check if two fields are within a tolerance.</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">discretisedfield</span> <span class="k">as</span> <span class="nn">df</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Mesh</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">p2</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">cell</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f1</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f2</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">3</span><span class="o">+</span><span class="mf">1e-9</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f3</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mf">3.1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f1</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">f2</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f1</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">f3</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f1</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">f3</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="mf">1e-2</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="discretisedfield.Field.derivative">
<span class="sig-name descname"><span class="pre">derivative</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">direction</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#discretisedfield.Field.derivative" title="Permalink to this definition">¶</a></dt>
<dd><p>Directional derivative.</p>
<p>This method computes a directional derivative of the field and returns
a field. The direction in which the derivative is computed is passed
via <code class="docutils literal notranslate"><span class="pre">direction</span></code> argument, which can be <code class="docutils literal notranslate"><span class="pre">'x'</span></code>, <code class="docutils literal notranslate"><span class="pre">'y'</span></code>, or <code class="docutils literal notranslate"><span class="pre">'z'</span></code>.
The order of the computed derivative can be 1 or 2 and it is specified
using argument <code class="docutils literal notranslate"><span class="pre">n</span></code> and it defaults to 1.</p>
<p>Directional derivative cannot be computed if only one discretisation
cell exists in a specified direction. In that case, a zero field is
returned. More precisely, it is assumed that the field does not change
in that direction. Computing of the directional derivative depends
strongly on the boundary condition specified in the mesh on which the
field is defined on. More precisely, the values of the derivatives at
the boundary are different for periodic, Neumann, or no boundary
conditions. For details on boundary conditions, please refer to the
<code class="docutils literal notranslate"><span class="pre">disretisedfield.Mesh</span></code> class. The derivatives are computed using
central differences inside the sample and using forward/backward
differences at the boundaries.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>direction</strong> (<em>str</em>) – The direction in which the derivative is computed. It can be
<code class="docutils literal notranslate"><span class="pre">'x'</span></code>, <code class="docutils literal notranslate"><span class="pre">'y'</span></code>, or <code class="docutils literal notranslate"><span class="pre">'z'</span></code>.</p></li>
<li><p><strong>n</strong> (<em>int</em>) – The order of the derivative. It can be 1 or 2 and it defaults to 1.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Directional derivative.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#discretisedfield.Field" title="discretisedfield.Field">discretisedfield.Field</a></p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>NotImplementedError</strong> – If order <code class="docutils literal notranslate"><span class="pre">n</span></code> higher than 2 is asked for.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>1. Compute the first-order directional derivative of a scalar field in
the y-direction of a spatially varying field. For the field we choose
<span class="math notranslate nohighlight">\(f(x, y, z) = 2x + 3y - 5z\)</span>. Accordingly, we expect the
derivative in the y-direction to be to be a constant scalar field
<span class="math notranslate nohighlight">\(df/dy = 3\)</span>.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">discretisedfield</span> <span class="k">as</span> <span class="nn">df</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p2</span> <span class="o">=</span> <span class="p">(</span><span class="mf">100e-9</span><span class="p">,</span> <span class="mf">100e-9</span><span class="p">,</span> <span class="mf">10e-9</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cell</span> <span class="o">=</span> <span class="p">(</span><span class="mf">10e-9</span><span class="p">,</span> <span class="mf">10e-9</span><span class="p">,</span> <span class="mf">10e-9</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Mesh</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="n">p2</span><span class="p">,</span> <span class="n">cell</span><span class="o">=</span><span class="n">cell</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">value_fun</span><span class="p">(</span><span class="n">point</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="n">point</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">y</span> <span class="o">+</span> <span class="o">-</span><span class="mi">5</span><span class="o">*</span><span class="n">z</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">value_fun</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">derivative</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">average</span>  <span class="c1"># first-order derivative by default</span>
<span class="go">3.0</span>
</pre></div>
</div>
<p>2. Try to compute the second-order directional derivative of the vector
field which has only one discretisation cell in the z-direction. For
the field we choose <span class="math notranslate nohighlight">\(f(x, y, z) = (2x, 3y, -5z)\)</span>. Accordingly, we
expect the directional derivatives to be: <span class="math notranslate nohighlight">\(df/dx = (2, 0, 0)\)</span>,
<span class="math notranslate nohighlight">\(df/dy=(0, 3, 0)\)</span>, <span class="math notranslate nohighlight">\(df/dz = (0, 0, -5)\)</span>. However, because
there is only one discretisation cell in the z-direction, the
derivative cannot be computed and a zero field is returned. Similarly,
second-order derivatives in all directions are expected to be zero.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">value_fun</span><span class="p">(</span><span class="n">point</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="n">point</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">,</span> <span class="mi">3</span><span class="o">*</span><span class="n">y</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="o">*</span><span class="n">z</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">value_fun</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">derivative</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">average</span>
<span class="go">(2.0, 0.0, 0.0)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">derivative</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">average</span>
<span class="go">(0.0, 3.0, 0.0)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">derivative</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">average</span>  <span class="c1"># derivative cannot be calculated</span>
<span class="go">(0.0, 0.0, 0.0)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># second-order derivatives</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="discretisedfield.Field.fromfile">
<em class="property"><span class="pre">classmethod</span> </em><span class="sig-name descname"><span class="pre">fromfile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#discretisedfield.Field.fromfile" title="Permalink to this definition">¶</a></dt>
<dd><p>Read the field from an OVF (1.0 or 2.0), VTK, or HDF5 file.</p>
<dl class="simple">
<dt>The extension of the <code class="docutils literal notranslate"><span class="pre">filename</span></code> should correspond to either:</dt><dd><ul class="simple">
<li><p>OVF (<code class="docutils literal notranslate"><span class="pre">.ovf</span></code>, <code class="docutils literal notranslate"><span class="pre">.omf</span></code>, <code class="docutils literal notranslate"><span class="pre">.ohf</span></code>, <code class="docutils literal notranslate"><span class="pre">.oef</span></code>)</p></li>
<li><p>VTK (<code class="docutils literal notranslate"><span class="pre">.vtk</span></code>), or</p></li>
<li><p>HDF5 (<code class="docutils literal notranslate"><span class="pre">.hdf5</span></code> or <code class="docutils literal notranslate"><span class="pre">.h5</span></code>).</p></li>
</ul>
</dd>
</dl>
<p>This is a <code class="docutils literal notranslate"><span class="pre">classmethod</span></code> and should be called as, for instance,
<code class="docutils literal notranslate"><span class="pre">discretisedfield.Field.fromfile('myfile.omf')</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>filename</strong> (<em>str</em>) – Name of the file to be read.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Field read from the file.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#discretisedfield.Field" title="discretisedfield.Field">discretisedfield.Field</a></p>
</dd>
</dl>
<p class="rubric">Example</p>
<ol class="arabic simple">
<li><p>Read the field from an OVF file.</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">os</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">discretisedfield</span> <span class="k">as</span> <span class="nn">df</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dirname</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="vm">__file__</span><span class="p">),</span>
<span class="gp">... </span>                       <span class="s1">&#39;tests&#39;</span><span class="p">,</span> <span class="s1">&#39;test_sample&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dirname</span><span class="p">,</span> <span class="s1">&#39;oommf-ovf2-bin4.omf&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="o">.</span><span class="n">fromfile</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span>
<span class="go">Field(mesh=...)</span>
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>Read a field from the VTK file.</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dirname</span><span class="p">,</span> <span class="s1">&#39;vtk-file.vtk&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="o">.</span><span class="n">fromfile</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span>
<span class="go">Field(mesh=...)</span>
</pre></div>
</div>
<ol class="arabic simple" start="3">
<li><p>Read a field from the HDF5 file.</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dirname</span><span class="p">,</span> <span class="s1">&#39;hdf5-file.hdf5&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="o">.</span><span class="n">fromfile</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span>
<span class="go">Field(mesh=...)</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-func docutils literal notranslate"><span class="pre">_fromovf()</span></code></p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-func docutils literal notranslate"><span class="pre">_fromhdf5()</span></code></p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-func docutils literal notranslate"><span class="pre">_fromhdf5()</span></code></p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#discretisedfield.Field.write" title="discretisedfield.Field.write"><code class="xref py py-func docutils literal notranslate"><span class="pre">write()</span></code></a></p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="discretisedfield.Field.integral">
<span class="sig-name descname"><span class="pre">integral</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">direction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'xyz'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">improper</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#discretisedfield.Field.integral" title="Permalink to this definition">¶</a></dt>
<dd><p>Integral.</p>
<p>This method integrates the field over the mesh along the specified
direction(s), which can ce specified using <code class="docutils literal notranslate"><span class="pre">direction</span></code>. Field must be
explicitly multiplied by an infinitesimal value (<code class="docutils literal notranslate"><span class="pre">DValue</span></code>) before
integration. Improper integral can be computed by passing
<code class="docutils literal notranslate"><span class="pre">improper=True</span></code> and by specifying a single direction.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>direction</strong> (<em>str</em><em>, </em><em>optional</em>) – Direction(s) along which the field is integrated. Defaults to
<code class="docutils literal notranslate"><span class="pre">'xyz'</span></code>.</p></li>
<li><p><strong>improper</strong> (<em>bool</em><em>, </em><em>optional</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, an improper (cumulative) integral is computed.
Defaults to <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Integration result. If the field is integrated in all directions,
<code class="docutils literal notranslate"><span class="pre">numbers.Real</span></code> or <code class="docutils literal notranslate"><span class="pre">array_like</span></code> value is returned depending on
the dimension of the field.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#discretisedfield.Field" title="discretisedfield.Field">discretisedfield.Field</a>, numbers.Real, or (3,) array_like</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – If <code class="docutils literal notranslate"><span class="pre">improper=True</span></code> and more than one integration direction is
    specified.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<ol class="arabic simple">
<li><p>Volume integral of a scalar field.</p></li>
</ol>
<div class="math notranslate nohighlight">
\[\int_\mathrm{V} f(\mathbf{r}) \mathrm{d}V\]</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">discretisedfield</span> <span class="k">as</span> <span class="nn">df</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cell</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Mesh</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="n">p2</span><span class="p">,</span> <span class="n">cell</span><span class="o">=</span><span class="n">cell</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">f</span> <span class="o">*</span> <span class="n">df</span><span class="o">.</span><span class="n">dV</span><span class="p">)</span><span class="o">.</span><span class="n">integral</span><span class="p">()</span>
<span class="go">5000.0</span>
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>Volume integral of a vector field.</p></li>
</ol>
<div class="math notranslate nohighlight">
\[\int_\mathrm{V} \mathbf{f}(\mathbf{r}) \mathrm{d}V\]</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">f</span> <span class="o">*</span> <span class="n">df</span><span class="o">.</span><span class="n">dV</span><span class="p">)</span><span class="o">.</span><span class="n">integral</span><span class="p">()</span>
<span class="go">(-1000.0, -2000.0, -3000.0)</span>
</pre></div>
</div>
<ol class="arabic simple" start="3">
<li><p>Surface integral of a scalar field.</p></li>
</ol>
<div class="math notranslate nohighlight">
\[\int_\mathrm{S} f(\mathbf{r}) |\mathrm{d}\mathbf{S}|\]</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f_plane</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">plane</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">f_plane</span> <span class="o">*</span> <span class="nb">abs</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">dS</span><span class="p">))</span><span class="o">.</span><span class="n">integral</span><span class="p">()</span>
<span class="go">500.0</span>
</pre></div>
</div>
<ol class="arabic simple" start="4">
<li><p>Surface integral of a vector field (flux).</p></li>
</ol>
<div class="math notranslate nohighlight">
\[\int_\mathrm{S} \mathbf{f}(\mathbf{r}) \cdot
\mathrm{d}\mathbf{S}\]</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f_plane</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">plane</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">f_plane</span> <span class="o">@</span> <span class="n">df</span><span class="o">.</span><span class="n">dS</span><span class="p">)</span><span class="o">.</span><span class="n">integral</span><span class="p">()</span>
<span class="go">300.0</span>
</pre></div>
</div>
<ol class="arabic simple" start="5">
<li><p>Integral along x-direction.</p></li>
</ol>
<div class="math notranslate nohighlight">
\[\int_{x_\mathrm{min}}^{x_\mathrm{max}} \mathbf{f}(\mathbf{r})
\mathrm{d}x\]</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f_plane</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">plane</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">f_plane</span> <span class="o">*</span> <span class="n">df</span><span class="o">.</span><span class="n">dx</span><span class="p">)</span><span class="o">.</span><span class="n">integral</span><span class="p">(</span><span class="n">direction</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">average</span>
<span class="go">(10.0, 20.0, 30.0)</span>
</pre></div>
</div>
<ol class="arabic simple" start="6">
<li><p>Improper integral along x-direction.</p></li>
</ol>
<div class="math notranslate nohighlight">
\[\int_{x_\mathrm{min}}^{x} \mathbf{f}(\mathbf{r})
\mathrm{d}x'\]</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f_plane</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">plane</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">f_plane</span> <span class="o">*</span> <span class="n">df</span><span class="o">.</span><span class="n">dx</span><span class="p">)</span><span class="o">.</span><span class="n">integral</span><span class="p">(</span><span class="n">direction</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">improper</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">Field(...)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="discretisedfield.Field.k3d_nonzero">
<span class="sig-name descname"><span class="pre">k3d_nonzero</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5010096</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multiplier</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interactive_field</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#discretisedfield.Field.k3d_nonzero" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="docutils literal notranslate"><span class="pre">k3d</span></code> plot of non-zero discretisation cells.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">plot</span></code> is not passed, <code class="docutils literal notranslate"><span class="pre">k3d.Plot</span></code> object is created
automatically. The colour of the non-zero discretisation cells can be
specified using <code class="docutils literal notranslate"><span class="pre">color</span></code> argument.</p>
<p>It is often the case that the object size is either small (e.g. on a
nanoscale) or very large (e.g. in units of kilometers). Accordingly,
<code class="docutils literal notranslate"><span class="pre">multiplier</span></code> can be passed as <span class="math notranslate nohighlight">\(10^{n}\)</span>, where <span class="math notranslate nohighlight">\(n\)</span> is a
multiple of 3 (…, -6, -3, 0, 3, 6,…). According to that value, the
axes will be scaled and appropriate units shown. For instance, if
<code class="docutils literal notranslate"><span class="pre">multiplier=1e-9</span></code> is passed, all axes will be divided by
<span class="math notranslate nohighlight">\(1\,\text{nm}\)</span> and <span class="math notranslate nohighlight">\(\text{nm}\)</span> units will be used as
axis labels. If <code class="docutils literal notranslate"><span class="pre">multiplier</span></code> is not passed, the best one is
calculated internally.</p>
<p>For interactive plots the field itself, before being sliced with the
field, must be passed as <code class="docutils literal notranslate"><span class="pre">interactive_field</span></code>. For example, if
<code class="docutils literal notranslate"><span class="pre">field.x.plane('z')</span></code> is plotted, <code class="docutils literal notranslate"><span class="pre">interactive_field=field</span></code> must be
passed. In addition, <code class="docutils literal notranslate"><span class="pre">k3d.plot</span></code> object cannot be created internally
and it must be passed and displayed by the user.</p>
<p>This method is based on <code class="docutils literal notranslate"><span class="pre">k3d.voxels</span></code>, so any keyword arguments
accepted by it can be passed (e.g. <code class="docutils literal notranslate"><span class="pre">wireframe</span></code>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>plot</strong> (<em>k3d.Plot</em><em>, </em><em>optional</em>) – Plot to which the plot is added. Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code> - plot is
created internally. This is not true in the case of an interactive
plot, when <code class="docutils literal notranslate"><span class="pre">plot</span></code> must be created externally.</p></li>
<li><p><strong>color</strong> (<em>int</em><em>, </em><em>optional</em>) – Colour of the non-zero discretisation cells. Defaults to the
default color palette.</p></li>
<li><p><strong>multiplier</strong> (<em>numbers.Real</em><em>, </em><em>optional</em>) – Axes multiplier. Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><strong>interactive_field</strong> (<a class="reference internal" href="#discretisedfield.Field" title="discretisedfield.Field"><em>discretisedfield.Field</em></a><em>, </em><em>optional</em>) – The whole field object (before any slices) used for interactive
plots. Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the dimension of the field is not 1.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<ol class="arabic simple">
<li><p>Visualising non-zero discretisation cells using <code class="docutils literal notranslate"><span class="pre">k3d</span></code>.</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">discretisedfield</span> <span class="k">as</span> <span class="nn">df</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p1</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mf">50e-9</span><span class="p">,</span> <span class="o">-</span><span class="mf">50e-9</span><span class="p">,</span> <span class="o">-</span><span class="mf">50e-9</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p2</span> <span class="o">=</span> <span class="p">(</span><span class="mf">50e-9</span><span class="p">,</span> <span class="mf">50e-9</span><span class="p">,</span> <span class="mf">50e-9</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Mesh</span><span class="p">(</span><span class="n">region</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">Region</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="n">p2</span><span class="p">),</span> <span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">normfun</span><span class="p">(</span><span class="n">point</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="n">point</span>
<span class="gp">... </span>    <span class="k">if</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">y</span><span class="o">**</span><span class="mi">2</span> <span class="o">&lt;</span> <span class="mi">30</span><span class="o">**</span><span class="mi">2</span><span class="p">:</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="mi">1</span>
<span class="gp">... </span>    <span class="k">else</span><span class="p">:</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span><span class="o">.</span><span class="n">norm</span> <span class="o">=</span> <span class="n">normfun</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">k3d_nonzero</span><span class="p">()</span>
<span class="go">Plot(...)</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-func docutils literal notranslate"><span class="pre">k3d_voxels()</span></code></p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="discretisedfield.Field.k3d_scalar">
<span class="sig-name descname"><span class="pre">k3d_scalar</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filter_field</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cividis'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multiplier</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interactive_field</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#discretisedfield.Field.k3d_scalar" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="docutils literal notranslate"><span class="pre">k3d</span></code> plot of a scalar field.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">plot</span></code> is not passed, <code class="docutils literal notranslate"><span class="pre">k3d.Plot</span></code> object is created
automatically. The colormap can be specified using <code class="docutils literal notranslate"><span class="pre">cmap</span></code> argument.
By passing <code class="docutils literal notranslate"><span class="pre">filter_field</span></code> the points at which the voxels are not
shown can be determined. More precisely, only those discretisation
cells where <code class="docutils literal notranslate"><span class="pre">filter_field</span> <span class="pre">!=</span> <span class="pre">0</span></code> are plotted.</p>
<p>It is often the case that the object size is either small (e.g. on a
nanoscale) or very large (e.g. in units of kilometers). Accordingly,
<code class="docutils literal notranslate"><span class="pre">multiplier</span></code> can be passed as <span class="math notranslate nohighlight">\(10^{n}\)</span>, where <span class="math notranslate nohighlight">\(n\)</span> is a
multiple of 3 (…, -6, -3, 0, 3, 6,…). According to that value, the
axes will be scaled and appropriate units shown. For instance, if
<code class="docutils literal notranslate"><span class="pre">multiplier=1e-9</span></code> is passed, all axes will be divided by
<span class="math notranslate nohighlight">\(1\,\text{nm}\)</span> and <span class="math notranslate nohighlight">\(\text{nm}\)</span> units will be used as
axis labels. If <code class="docutils literal notranslate"><span class="pre">multiplier</span></code> is not passed, the best one is
calculated internally.</p>
<p>For interactive plots the field itself, before being sliced with the
field, must be passed as <code class="docutils literal notranslate"><span class="pre">interactive_field</span></code>. For example, if
<code class="docutils literal notranslate"><span class="pre">field.x.plane('z')</span></code> is plotted, <code class="docutils literal notranslate"><span class="pre">interactive_field=field</span></code> must be
passed. In addition, <code class="docutils literal notranslate"><span class="pre">k3d.plot</span></code> object cannot be created internally
and it must be passed and displayed by the user.</p>
<p>This method is based on <code class="docutils literal notranslate"><span class="pre">k3d.voxels</span></code>, so any keyword arguments
accepted by it can be passed (e.g. <code class="docutils literal notranslate"><span class="pre">wireframe</span></code>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>plot</strong> (<em>k3d.Plot</em><em>, </em><em>optional</em>) – Plot to which the plot is added. Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code> - plot is
created internally. This is not true in the case of an interactive
plot, when <code class="docutils literal notranslate"><span class="pre">plot</span></code> must be created externally.</p></li>
<li><p><strong>filter_field</strong> (<a class="reference internal" href="#discretisedfield.Field" title="discretisedfield.Field"><em>discretisedfield.Field</em></a><em>, </em><em>optional</em>) – Scalar field. Only discretisation cells where <code class="docutils literal notranslate"><span class="pre">filter_field</span> <span class="pre">!=</span> <span class="pre">0</span></code>
are shown. Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><strong>cmap</strong> (<em>str</em><em>, </em><em>optional</em>) – Colormap.</p></li>
<li><p><strong>multiplier</strong> (<em>numbers.Real</em><em>, </em><em>optional</em>) – Axes multiplier. Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><strong>interactive_field</strong> (<a class="reference internal" href="#discretisedfield.Field" title="discretisedfield.Field"><em>discretisedfield.Field</em></a><em>, </em><em>optional</em>) – The whole field object (before any slices) used for interactive
plots. Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the dimension of the field is not 1.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<ol class="arabic simple">
<li><p>Plot the scalar field using <code class="docutils literal notranslate"><span class="pre">k3d</span></code>.</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">discretisedfield</span> <span class="k">as</span> <span class="nn">df</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p1</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">50</span><span class="p">,</span> <span class="o">-</span><span class="mi">50</span><span class="p">,</span> <span class="o">-</span><span class="mi">50</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Mesh</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="n">p2</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span><span class="o">.</span><span class="n">k3d_scalar</span><span class="p">()</span>
<span class="go">Plot(...)</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#discretisedfield.Field.k3d_vector" title="discretisedfield.Field.k3d_vector"><code class="xref py py-func docutils literal notranslate"><span class="pre">k3d_vector()</span></code></a></p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="discretisedfield.Field.k3d_vector">
<span class="sig-name descname"><span class="pre">k3d_vector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color_field</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cividis'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">head_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">points</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">point_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vector_multiplier</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multiplier</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interactive_field</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#discretisedfield.Field.k3d_vector" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="docutils literal notranslate"><span class="pre">k3d</span></code> plot of a vector field.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">plot</span></code> is not passed, <code class="docutils literal notranslate"><span class="pre">k3d.Plot</span></code> object is created
automatically. By passing <code class="docutils literal notranslate"><span class="pre">color_field</span></code> vectors are coloured
according to the values of that field. The colormap can be specified
using <code class="docutils literal notranslate"><span class="pre">cmap</span></code> argument. The head size of vectors can be changed using
<code class="docutils literal notranslate"><span class="pre">head_size</span></code>. The size of the plotted vectors is computed
automatically in order to fit the plot. However, it can be adjusted
using <code class="docutils literal notranslate"><span class="pre">vector_multiplier</span></code>.</p>
<p>By default both vectors and points, corresponding to discretisation
cell coordinates, are plotted. They can be removed from the plot by
passing <code class="docutils literal notranslate"><span class="pre">points=False</span></code>. The size of the points are calculated
automatically, but it can be adjusted with <code class="docutils literal notranslate"><span class="pre">point_size</span></code>.</p>
<p>It is often the case that the object size is either small (e.g. on a
nanoscale) or very large (e.g. in units of kilometers). Accordingly,
<code class="docutils literal notranslate"><span class="pre">multiplier</span></code> can be passed as <span class="math notranslate nohighlight">\(10^{n}\)</span>, where <span class="math notranslate nohighlight">\(n\)</span> is a
multiple of 3 (…, -6, -3, 0, 3, 6,…). According to that value, the
axes will be scaled and appropriate units shown. For instance, if
<code class="docutils literal notranslate"><span class="pre">multiplier=1e-9</span></code> is passed, all axes will be divided by
<span class="math notranslate nohighlight">\(1\,\text{nm}\)</span> and <span class="math notranslate nohighlight">\(\text{nm}\)</span> units will be used as
axis labels. If <code class="docutils literal notranslate"><span class="pre">multiplier</span></code> is not passed, the best one is
calculated internally.</p>
<p>For interactive plots the field itself, before being sliced with the
field, must be passed as <code class="docutils literal notranslate"><span class="pre">interactive_field</span></code>. For example, if
<code class="docutils literal notranslate"><span class="pre">field.plane('z')</span></code> is plotted, <code class="docutils literal notranslate"><span class="pre">interactive_field=field</span></code> must be
passed. In addition, <code class="docutils literal notranslate"><span class="pre">k3d.plot</span></code> object cannot be created internally
and it must be passed and displayed by the user.</p>
<p>This method is based on <code class="docutils literal notranslate"><span class="pre">k3d.voxels</span></code>, so any keyword arguments
accepted by it can be passed (e.g. <code class="docutils literal notranslate"><span class="pre">wireframe</span></code>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>plot</strong> (<em>k3d.Plot</em><em>, </em><em>optional</em>) – Plot to which the plot is added. Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code> - plot is
created internally. This is not true in the case of an interactive
plot, when <code class="docutils literal notranslate"><span class="pre">plot</span></code> must be created externally.</p></li>
<li><p><strong>color_field</strong> (<a class="reference internal" href="#discretisedfield.Field" title="discretisedfield.Field"><em>discretisedfield.Field</em></a><em>, </em><em>optional</em>) – Scalar field. Vectors are coloured according to the values of
<code class="docutils literal notranslate"><span class="pre">color_field</span></code>. Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><strong>cmap</strong> (<em>str</em><em>, </em><em>optional</em>) – Colormap.</p></li>
<li><p><strong>head_size</strong> (<em>int</em><em>, </em><em>optional</em>) – The size of vector heads. Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><strong>points</strong> (<em>bool</em><em>, </em><em>optional</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, points are shown together with vectors. Defaults to
<code class="docutils literal notranslate"><span class="pre">True</span></code>.</p></li>
<li><p><strong>point_size</strong> (<em>int</em><em>, </em><em>optional</em>) – The size of the points if shown in the plot. Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><strong>vector_multiplier</strong> (<em>numbers.Real</em><em>, </em><em>optional</em>) – All vectors are divided by this value before being plotted.
Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><strong>multiplier</strong> (<em>numbers.Real</em><em>, </em><em>optional</em>) – Axes multiplier. Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><strong>interactive_field</strong> (<a class="reference internal" href="#discretisedfield.Field" title="discretisedfield.Field"><em>discretisedfield.Field</em></a><em>, </em><em>optional</em>) – The whole field object (before any slices) used for interactive
plots. Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the dimension of the field is not 3.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<ol class="arabic simple">
<li><p>Visualising the vector field using <code class="docutils literal notranslate"><span class="pre">k3d</span></code>.</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">p1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Mesh</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="n">p2</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span><span class="o">.</span><span class="n">k3d_vector</span><span class="p">()</span>
<span class="go">Plot(...)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="discretisedfield.Field.line">
<span class="sig-name descname"><span class="pre">line</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#discretisedfield.Field.line" title="Permalink to this definition">¶</a></dt>
<dd><p>Sampling the field along the line.</p>
<p>Given two points <span class="math notranslate nohighlight">\(p_{1}\)</span> and <span class="math notranslate nohighlight">\(p_{2}\)</span>, <span class="math notranslate nohighlight">\(n\)</span> position
coordinates are generated and the corresponding field values.</p>
<div class="math notranslate nohighlight">
\[\mathbf{r}_{i} = i\frac{\mathbf{p}_{2} -
\mathbf{p}_{1}}{n-1}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>p1</strong> (<em>(</em><em>3</em><em>,</em><em>) </em><em>array_like</em>) – Two points between which the line is generated.</p></li>
<li><p><strong>p2</strong> (<em>(</em><em>3</em><em>,</em><em>) </em><em>array_like</em>) – Two points between which the line is generated.</p></li>
<li><p><strong>n</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of points on the line. Defaults to 100.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Line object.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="discretisedfield.Line.html#discretisedfield.Line" title="discretisedfield.Line">discretisedfield.Line</a></p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – If <code class="docutils literal notranslate"><span class="pre">p1</span></code> or <code class="docutils literal notranslate"><span class="pre">p2</span></code> is outside the mesh domain.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<ol class="arabic simple">
<li><p>Sampling the field along the line.</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">discretisedfield</span> <span class="k">as</span> <span class="nn">df</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cell</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Mesh</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="n">p2</span><span class="p">,</span> <span class="n">cell</span><span class="o">=</span><span class="n">cell</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">line</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">p2</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">n</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="discretisedfield.Field.mpl">
<span class="sig-name descname"><span class="pre">mpl</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scalar_field</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scalar_filter_field</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scalar_lightness_field</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scalar_cmap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'viridis'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scalar_clim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scalar_colorbar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scalar_colorbar_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vector_field</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vector_color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vector_color_field</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vector_cmap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cividis'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vector_clim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vector_colorbar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vector_colorbar_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vector_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multiplier</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#discretisedfield.Field.mpl" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots the field on a plane.</p>
<p>This is a convenience method used for quick plotting, which combines
<code class="docutils literal notranslate"><span class="pre">discretisedfield.Field.mpl_scalar</span></code> and
<code class="docutils literal notranslate"><span class="pre">discretisedfield.Field.mpl_vector</span></code> methods. Depending on the
dimensionality of the field, it determines what plot is going to be
shown. For a scalar field only <code class="docutils literal notranslate"><span class="pre">discretisedfield.Field.mpl_scalar</span></code> is
used, whereas for a vector field, both
<code class="docutils literal notranslate"><span class="pre">discretisedfield.Field.mpl_scalar</span></code> and
<code class="docutils literal notranslate"><span class="pre">discretisedfield.Field.mpl_vector</span></code> plots are shown, where vector
plot shows the in-plane components of the vector and scalar plot
encodes the out-of-plane component.</p>
<p>All the default values can be changed by passing arguments, which are
then used in subplots. The way parameters of this function are used to
create plots can be understood with the following code snippet.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>if ax is None:
    fig = plt.figure(figsize=figsize)
    ax = fig.add_subplot(111)

scalar_field.mpl_scalar(ax=ax, filter_field=scalar_filter_field,
                        lightness_field=scalar_lightness_field,
                        colorbar=scalar_colorbar,
                        colorbar_label=scalar_colorbar_label,
                        multiplier=multiplier, cmap=scalar_cmap,
                        clim=scalar_clim,)

vector_field.mpl_vector(ax=ax, color=vector_color,
                        color_field=vector_color_field,
                        colorbar=vector_colorbar,
                        colorbar_label=vector_colorbar_label,
                        multiplier=multiplier, scale=vector_scale,
                        cmap=vector_cmap, clim=vector_clim,)

if filename is not None:
    plt.savefig(filename, bbox_inches=&#39;tight&#39;, pad_inches=0.02)
```

Therefore, to understand the meaning of the arguments which can be
passed to this method, please refer to
``discretisedfield.Field.mpl_scalar`` and
``discretisedfield.Field.mpl_vector`` documentation.
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><strong>ValueError</strong> – If the field has not been sliced with a plane.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<ol class="arabic simple">
<li><p>Visualising the field using <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code>.</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">discretisedfield</span> <span class="k">as</span> <span class="nn">df</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Mesh</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="n">p2</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span><span class="o">.</span><span class="n">plane</span><span class="p">(</span><span class="n">z</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span><span class="o">.</span><span class="n">mpl</span><span class="p">()</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#discretisedfield.Field.mpl_scalar" title="discretisedfield.Field.mpl_scalar"><code class="xref py py-func docutils literal notranslate"><span class="pre">mpl_scalar()</span></code></a>
<a class="reference internal" href="#discretisedfield.Field.mpl_vector" title="discretisedfield.Field.mpl_vector"><code class="xref py py-func docutils literal notranslate"><span class="pre">mpl_vector()</span></code></a></p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="discretisedfield.Field.mpl_scalar">
<span class="sig-name descname"><span class="pre">mpl_scalar</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filter_field</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lightness_field</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colorbar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colorbar_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multiplier</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#discretisedfield.Field.mpl_scalar" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots the scalar field on a plane.</p>
<p>Before the field can be plotted, it must be sliced with a plane (e.g.
<code class="docutils literal notranslate"><span class="pre">field.plane('z')</span></code>). In addition, field must be a scalar field
(<code class="docutils literal notranslate"><span class="pre">dim=1</span></code>). Otherwise, <code class="docutils literal notranslate"><span class="pre">ValueError</span></code> is raised. <code class="docutils literal notranslate"><span class="pre">mpl_scalar</span></code> adds
the plot to <code class="docutils literal notranslate"><span class="pre">matplotlib.axes.Axes</span></code> passed via <code class="docutils literal notranslate"><span class="pre">ax</span></code> argument. If
<code class="docutils literal notranslate"><span class="pre">ax</span></code> is not passed, <code class="docutils literal notranslate"><span class="pre">matplotlib.axes.Axes</span></code> object is created
automatically and the size of a figure can be specified using
<code class="docutils literal notranslate"><span class="pre">figsize</span></code>. By passing <code class="docutils literal notranslate"><span class="pre">filter_field</span></code> the points at which the pixels
are not coloured can be determined. More precisely, only those
discretisation cells where <code class="docutils literal notranslate"><span class="pre">filter_field</span> <span class="pre">!=</span> <span class="pre">0</span></code> are plotted. By
passing a scalar field as <code class="docutils literal notranslate"><span class="pre">lightness_field</span></code>, ligtness component is
added to HSL colormap. In this case, colormap cannot be passed using
<code class="docutils literal notranslate"><span class="pre">kwargs</span></code>. Colorbar is shown by default and it can be removed from the
plot by passing <code class="docutils literal notranslate"><span class="pre">colorbar=False</span></code>. The label for the colorbar can be
defined by passing <code class="docutils literal notranslate"><span class="pre">colorbar_label</span></code> as a string.</p>
<p>It is often the case that the region size is small (e.g. on a
nanoscale) or very large (e.g. in units of kilometers). Accordingly,
<code class="docutils literal notranslate"><span class="pre">multiplier</span></code> can be passed as <span class="math notranslate nohighlight">\(10^{n}\)</span>, where <span class="math notranslate nohighlight">\(n\)</span> is a
multiple of 3  (…, -6, -3, 0, 3, 6,…). According to that value, the
axes will be scaled and appropriate units shown. For instance, if
<code class="docutils literal notranslate"><span class="pre">multiplier=1e-9</span></code> is passed, all mesh points will be divided by
<span class="math notranslate nohighlight">\(1\,\text{nm}\)</span> and <span class="math notranslate nohighlight">\(\text{nm}\)</span> units will be used as
axis labels. If <code class="docutils literal notranslate"><span class="pre">multiplier</span></code> is not passed, the best one is
calculated internally. The plot can be saved as a PDF when <code class="docutils literal notranslate"><span class="pre">filename</span></code>
is passed.</p>
<p>This method plots the field using <code class="docutils literal notranslate"><span class="pre">matplotlib.pyplot.imshow</span></code>
function, so any keyword arguments accepted by it can be passed (for
instance, <code class="docutils literal notranslate"><span class="pre">cmap</span></code> - colormap, <code class="docutils literal notranslate"><span class="pre">clim</span></code> - colorbar limits, etc.).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ax</strong> (<em>matplotlib.axes.Axes</em><em>, </em><em>optional</em>) – Axes to which the field plot is added. Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code> - axes
are created internally.</p></li>
<li><p><strong>figsize</strong> (<em>(</em><em>2</em><em>,</em><em>) </em><em>tuple</em><em>, </em><em>optional</em>) – The size of a created figure if <code class="docutils literal notranslate"><span class="pre">ax</span></code> is not passed. Defaults to
<code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><strong>filter_field</strong> (<a class="reference internal" href="#discretisedfield.Field" title="discretisedfield.Field"><em>discretisedfield.Field</em></a><em>, </em><em>optional</em>) – A scalar field used for determining whether certain discretisation
cells are coloured. More precisely, only those discretisation cells
where <code class="docutils literal notranslate"><span class="pre">filter_field</span> <span class="pre">!=</span> <span class="pre">0</span></code> are plotted. Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><strong>lightness_field</strong> (<a class="reference internal" href="#discretisedfield.Field" title="discretisedfield.Field"><em>discretisedfield.Field</em></a><em>, </em><em>optional</em>) – A scalar field used for adding lightness to the color. Field values
are hue. Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><strong>colorbar</strong> (<em>bool</em><em>, </em><em>optional</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, colorbar is shown and it is hidden when <code class="docutils literal notranslate"><span class="pre">False</span></code>.
Defaults to <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p></li>
<li><p><strong>colorbar_label</strong> (<em>str</em><em>, </em><em>optional</em>) – Colorbar label. Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><strong>multiplier</strong> (<em>numbers.Real</em><em>, </em><em>optional</em>) – <code class="docutils literal notranslate"><span class="pre">multiplier</span></code> can be passed as <span class="math notranslate nohighlight">\(10^{n}\)</span>, where <span class="math notranslate nohighlight">\(n\)</span> is
a multiple of 3 (…, -6, -3, 0, 3, 6,…). According to that
value, the axes will be scaled and appropriate units shown. For
instance, if <code class="docutils literal notranslate"><span class="pre">multiplier=1e-9</span></code> is passed, the mesh points will be
divided by <span class="math notranslate nohighlight">\(1\,\text{nm}\)</span> and <span class="math notranslate nohighlight">\(\text{nm}\)</span> units will
be used as axis labels. Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><strong>filename</strong> (<em>str</em><em>, </em><em>optional</em>) – If filename is passed, the plot is saved. Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the field has not been sliced, its dimension is not 1, or the
    dimension of <code class="docutils literal notranslate"><span class="pre">filter_field</span></code> is not 1.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<ol class="arabic simple">
<li><p>Visualising the scalar field using <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code>.</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">discretisedfield</span> <span class="k">as</span> <span class="nn">df</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Mesh</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="n">p2</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span><span class="o">.</span><span class="n">plane</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mpl_scalar</span><span class="p">()</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#discretisedfield.Field.mpl_vector" title="discretisedfield.Field.mpl_vector"><code class="xref py py-func docutils literal notranslate"><span class="pre">mpl_vector()</span></code></a></p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="discretisedfield.Field.mpl_vector">
<span class="sig-name descname"><span class="pre">mpl_vector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color_field</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colorbar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colorbar_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multiplier</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#discretisedfield.Field.mpl_vector" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots the vector field on a plane.</p>
<p>Before the field can be plotted, it must be sliced with a plane (e.g.
<code class="docutils literal notranslate"><span class="pre">field.plane('z')</span></code>). In addition, field must be a vector field
(<code class="docutils literal notranslate"><span class="pre">dim=3</span></code>). Otherwise, <code class="docutils literal notranslate"><span class="pre">ValueError</span></code> is raised. <code class="docutils literal notranslate"><span class="pre">mpl_vector</span></code> adds
the plot to <code class="docutils literal notranslate"><span class="pre">matplotlib.axes.Axes</span></code> passed via <code class="docutils literal notranslate"><span class="pre">ax</span></code> argument. If
<code class="docutils literal notranslate"><span class="pre">ax</span></code> is not passed, <code class="docutils literal notranslate"><span class="pre">matplotlib.axes.Axes</span></code> object is created
automatically and the size of a figure can be specified using
<code class="docutils literal notranslate"><span class="pre">figsize</span></code>. By default, plotted vectors are coloured according to the
out-of-plane component of the vectors. This can be changed by passing
<code class="docutils literal notranslate"><span class="pre">color_field</span></code> with <code class="docutils literal notranslate"><span class="pre">dim=1</span></code>. To disable colouring of the plot,
<code class="docutils literal notranslate"><span class="pre">color=False</span></code> can be passed. Colorbar is shown by default and it can
be removed from the plot by passing <code class="docutils literal notranslate"><span class="pre">colorbar=False</span></code>. The label for
the colorbar can be defined by passing <code class="docutils literal notranslate"><span class="pre">colorbar_label</span></code> as a string.
It is often the case that the region size is small (e.g. on a
nanoscale) or very large (e.g. in units of kilometers). Accordingly,
<code class="docutils literal notranslate"><span class="pre">multiplier</span></code> can be passed as <span class="math notranslate nohighlight">\(10^{n}\)</span>, where <span class="math notranslate nohighlight">\(n\)</span> is a
multiple of 3  (…, -6, -3, 0, 3, 6,…). According to that value, the
axes will be scaled and appropriate units shown. For instance, if
<code class="docutils literal notranslate"><span class="pre">multiplier=1e-9</span></code> is passed, all mesh points will be divided by
<span class="math notranslate nohighlight">\(1\,\text{nm}\)</span> and <span class="math notranslate nohighlight">\(\text{nm}\)</span> units will be used as
axis labels. If <code class="docutils literal notranslate"><span class="pre">multiplier</span></code> is not passed, the best one is
calculated internally. The plot can be saved as a PDF when <code class="docutils literal notranslate"><span class="pre">filename</span></code>
is passed.</p>
<p>This method plots the field using <code class="docutils literal notranslate"><span class="pre">matplotlib.pyplot.quiver</span></code>
function, so any keyword arguments accepted by it can be passed (for
instance, <code class="docutils literal notranslate"><span class="pre">cmap</span></code> - colormap, <code class="docutils literal notranslate"><span class="pre">clim</span></code> - colorbar limits, etc.). In
particular, there are cases when <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code> fails to find optimal
scale for plotting vectors. More precisely, sometimes vectors appear
too large in the plot. This can be resolved by passing <code class="docutils literal notranslate"><span class="pre">scale</span></code>
argument, which scales all vectors in the plot. In other words, larger
<code class="docutils literal notranslate"><span class="pre">scale</span></code>, smaller the vectors and vice versa. Please note that scale
can be in a very large range (e.g. 1e20).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ax</strong> (<em>matplotlib.axes.Axes</em><em>, </em><em>optional</em>) – Axes to which the field plot is added. Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code> - axes
are created internally.</p></li>
<li><p><strong>figsize</strong> (<em>tuple</em><em>, </em><em>optional</em>) – The size of a created figure if <code class="docutils literal notranslate"><span class="pre">ax</span></code> is not passed. Defaults to
<code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><strong>color_field</strong> (<a class="reference internal" href="#discretisedfield.Field" title="discretisedfield.Field"><em>discretisedfield.Field</em></a><em>, </em><em>optional</em>) – A scalar field used for colouring the vectors. Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code>
and vectors are coloured according to their out-of-plane
components.</p></li>
<li><p><strong>colorbar</strong> (<em>bool</em><em>, </em><em>optional</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, colorbar is shown and it is hidden when <code class="docutils literal notranslate"><span class="pre">False</span></code>.
Defaults to <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p></li>
<li><p><strong>colorbar_label</strong> (<em>str</em><em>, </em><em>optional</em>) – Colorbar label. Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><strong>multiplier</strong> (<em>numbers.Real</em><em>, </em><em>optional</em>) – <code class="docutils literal notranslate"><span class="pre">multiplier</span></code> can be passed as <span class="math notranslate nohighlight">\(10^{n}\)</span>, where <span class="math notranslate nohighlight">\(n\)</span> is
a multiple of 3 (…, -6, -3, 0, 3, 6,…). According to that
value, the axes will be scaled and appropriate units shown. For
instance, if <code class="docutils literal notranslate"><span class="pre">multiplier=1e-9</span></code> is passed, the mesh points will be
divided by <span class="math notranslate nohighlight">\(1\,\text{nm}\)</span> and <span class="math notranslate nohighlight">\(\text{nm}\)</span> units will
be used as axis labels. Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><strong>filename</strong> (<em>str</em><em>, </em><em>optional</em>) – If filename is passed, the plot is saved. Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the field has not been sliced, its dimension is not 3, or the
    dimension of <code class="docutils literal notranslate"><span class="pre">color_field</span></code> is not 1.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<ol class="arabic simple">
<li><p>Visualising the vector field using <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code>.</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">discretisedfield</span> <span class="k">as</span> <span class="nn">df</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Mesh</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="n">p2</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="p">(</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">2.1</span><span class="p">,</span> <span class="mf">3.1</span><span class="p">))</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span><span class="o">.</span><span class="n">plane</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mpl_vector</span><span class="p">()</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#discretisedfield.Field.mpl_scalar" title="discretisedfield.Field.mpl_scalar"><code class="xref py py-func docutils literal notranslate"><span class="pre">mpl_scalar()</span></code></a></p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="discretisedfield.Field.pad">
<span class="sig-name descname"><span class="pre">pad</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pad_width</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#discretisedfield.Field.pad" title="Permalink to this definition">¶</a></dt>
<dd><p>Field padding.</p>
<p>This method pads the field by adding more cells in chosen direction and
assigning to them the values as specified by the <code class="docutils literal notranslate"><span class="pre">mode</span></code> argument.
The way in which the field is going to padded is defined by passing
<code class="docutils literal notranslate"><span class="pre">pad_width</span></code> dictionary. The keys of the dictionary are the directions
(axes), e.g. <code class="docutils literal notranslate"><span class="pre">'x'</span></code>, <code class="docutils literal notranslate"><span class="pre">'y'</span></code>, or <code class="docutils literal notranslate"><span class="pre">'z'</span></code>, whereas the values are the
tuples of length 2. The first integer in the tuple is the number of
cells added in the negative direction, and the second integer is the
number of cells added in the positive direction.</p>
<p>This method accepts any other arguments allowed by <code class="docutils literal notranslate"><span class="pre">numpy.pad</span></code>
function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pad_width</strong> (<em>dict</em>) – The keys of the dictionary are the directions (axes), e.g. <code class="docutils literal notranslate"><span class="pre">'x'</span></code>,
<code class="docutils literal notranslate"><span class="pre">'y'</span></code>, or <code class="docutils literal notranslate"><span class="pre">'z'</span></code>, whereas the values are the tuples of length 2.
The first integer in the tuple is the number of cells added in the
negative direction, and the second integer is the number of cells
added in the positive direction.</p></li>
<li><p><strong>mode</strong> (<em>str</em>) – Padding mode as defined in <code class="docutils literal notranslate"><span class="pre">numpy.pad</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Padded field.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#discretisedfield.Field" title="discretisedfield.Field">discretisedfield.Field</a></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<ol class="arabic simple">
<li><p>Padding a field in the x direction by 1 cell with <code class="docutils literal notranslate"><span class="pre">constant</span></code> mode.</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">discretisedfield</span> <span class="k">as</span> <span class="nn">df</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cell</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Mesh</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="n">p2</span><span class="p">,</span> <span class="n">cell</span><span class="o">=</span><span class="n">cell</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Two cells with value 1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pf</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">pad</span><span class="p">({</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)},</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;constant&#39;</span><span class="p">)</span>  <span class="c1"># zeros padded</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pf</span><span class="o">.</span><span class="n">average</span>
<span class="go">0.5</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="discretisedfield.Field.plane">
<span class="sig-name descname"><span class="pre">plane</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#discretisedfield.Field.plane" title="Permalink to this definition">¶</a></dt>
<dd><p>Extracts field on the plane mesh.</p>
<p>If one of the axes (<code class="docutils literal notranslate"><span class="pre">'x'</span></code>, <code class="docutils literal notranslate"><span class="pre">'y'</span></code>, or <code class="docutils literal notranslate"><span class="pre">'z'</span></code>) is passed as a
string, a plane mesh perpendicular to that axis is extracted,
intersecting the mesh region at its centre, and the field is sampled on
that mesh. Alternatively, if a keyword argument is passed (e.g.
<code class="docutils literal notranslate"><span class="pre">x=1e-9</span></code>), a plane perpendicular to the x-axis (parallel to yz-plane)
and intersecting it at <code class="docutils literal notranslate"><span class="pre">x=1e-9</span></code> is extracted. The number of points in
two dimensions on the plane can be defined using <code class="docutils literal notranslate"><span class="pre">n</span></code> tuple (e.g.
<code class="docutils literal notranslate"><span class="pre">n=(10,</span> <span class="pre">15)</span></code>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>n</strong> (<em>(</em><em>2</em><em>,</em><em>) </em><em>tuple</em>) – The number of points on the plane in two dimensions.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>An extracted field.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#discretisedfield.Field" title="discretisedfield.Field">discretisedfield.Field</a></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<ol class="arabic simple">
<li><p>Extracting the field on a plane at a specific point.</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">discretisedfield</span> <span class="k">as</span> <span class="nn">df</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cell</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Mesh</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="n">p2</span><span class="p">,</span> <span class="n">cell</span><span class="o">=</span><span class="n">cell</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">plane</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">Field(...)</span>
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>Extracting the field at the mesh region centre.</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">plane</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">)</span>
<span class="go">Field(...)</span>
</pre></div>
</div>
<ol class="arabic simple" start="3">
<li><p>Specifying the number of points.</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">plane</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="go">Field(...)</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="discretisedfield.Mesh.html#discretisedfield.Mesh.plane" title="discretisedfield.Mesh.plane"><code class="xref py py-func docutils literal notranslate"><span class="pre">plane()</span></code></a></p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="discretisedfield.Field.project">
<span class="sig-name descname"><span class="pre">project</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">direction</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#discretisedfield.Field.project" title="Permalink to this definition">¶</a></dt>
<dd><p>Projects the field along one direction and averages it out along
that direction.</p>
<p>One of the axes (<code class="docutils literal notranslate"><span class="pre">'x'</span></code>, <code class="docutils literal notranslate"><span class="pre">'y'</span></code>, or <code class="docutils literal notranslate"><span class="pre">'z'</span></code>) is passed and the field
is projected (averaged) along that direction. For example
<code class="docutils literal notranslate"><span class="pre">project('z')</span></code> would average the field in the z-direction and return
the field which has only one discretisation cell in the z-direction.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>direction</strong> (<em>str</em>) – Direction along which the field is projected (<code class="docutils literal notranslate"><span class="pre">'x'</span></code>, <code class="docutils literal notranslate"><span class="pre">'y'</span></code>, or
<code class="docutils literal notranslate"><span class="pre">'z'</span></code>).</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A projected field.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#discretisedfield.Field" title="discretisedfield.Field">discretisedfield.Field</a></p>
</dd>
</dl>
<p class="rubric">Example</p>
<ol class="arabic simple">
<li><p>Projecting the field along a certain direction.</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">discretisedfield</span> <span class="k">as</span> <span class="nn">df</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cell</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Mesh</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="n">p2</span><span class="p">,</span> <span class="n">cell</span><span class="o">=</span><span class="n">cell</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span><span class="o">.</span><span class="n">project</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">)</span>
<span class="go">Field(...)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span><span class="o">.</span><span class="n">project</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">average</span>
<span class="go">(1.0, 2.0, 3.0)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span><span class="o">.</span><span class="n">project</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">array</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(2, 2, 1, 3)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="discretisedfield.Field.write">
<span class="sig-name descname"><span class="pre">write</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">representation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'txt'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extend_scalar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#discretisedfield.Field.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Write the field to OVF, HDF5, or VTK file.</p>
<p>If the extension of <code class="docutils literal notranslate"><span class="pre">filename</span></code> is <code class="docutils literal notranslate"><span class="pre">.vtk</span></code>, a VTK file is written
(<code class="xref py py-func docutils literal notranslate"><span class="pre">_writevtk()</span></code>).</p>
<p>For <code class="docutils literal notranslate"><span class="pre">.ovf</span></code>, <code class="docutils literal notranslate"><span class="pre">.omf</span></code>, or <code class="docutils literal notranslate"><span class="pre">.ohf</span></code> extensions, the field is saved to
OVF file (<code class="xref py py-func docutils literal notranslate"><span class="pre">_writeovf()</span></code>). In that case,
the representation of data (<code class="docutils literal notranslate"><span class="pre">'bin4'</span></code>, <code class="docutils literal notranslate"><span class="pre">'bin8'</span></code>, or <code class="docutils literal notranslate"><span class="pre">'txt'</span></code>) is
passed as <code class="docutils literal notranslate"><span class="pre">representation</span></code> and if <code class="docutils literal notranslate"><span class="pre">extend_scalar=True</span></code>, a scalar
field will be saved as a vector field. More precisely, if the value at
a cell is X, that cell will be saved as (X, 0, 0).</p>
<p>Finally, if the extension of <code class="docutils literal notranslate"><span class="pre">filename</span></code> is <code class="docutils literal notranslate"><span class="pre">.hdf5</span></code>, HDF5 file will
be written (<code class="xref py py-func docutils literal notranslate"><span class="pre">_writehdf5()</span></code>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>str</em>) – Name of the file written.</p></li>
<li><p><strong>representation</strong> (<em>str</em><em>, </em><em>optional</em>) – In the case of OVF files (<code class="docutils literal notranslate"><span class="pre">.ovf</span></code>, <code class="docutils literal notranslate"><span class="pre">.omf</span></code>, or <code class="docutils literal notranslate"><span class="pre">.ohf</span></code>),
representation can be specified (<code class="docutils literal notranslate"><span class="pre">'bin4'</span></code>, <code class="docutils literal notranslate"><span class="pre">'bin8'</span></code>, or
<code class="docutils literal notranslate"><span class="pre">'txt'</span></code>). Defaults to <code class="docutils literal notranslate"><span class="pre">'txt'</span></code>.</p></li>
<li><p><strong>extend_scalar</strong> (<em>bool</em><em>, </em><em>optional</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, a scalar field will be saved as a vector field. More
precisely, if the value at a cell is 3, that cell will be saved as
(3, 0, 0). This is valid only for the OVF file formats. Defaults to
<code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<ol class="arabic simple">
<li><p>Write field to the OVF file.</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">os</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">discretisedfield</span> <span class="k">as</span> <span class="nn">df</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mf">5e-9</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p2</span> <span class="o">=</span> <span class="p">(</span><span class="mf">5e-9</span><span class="p">,</span> <span class="mf">15e-9</span><span class="p">,</span> <span class="mf">15e-9</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Mesh</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="n">p2</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;mytestfile.omf&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>  <span class="c1"># write the file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field_read</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="o">.</span><span class="n">fromfile</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>  <span class="c1"># read the file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field_read</span> <span class="o">==</span> <span class="n">field</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>  <span class="c1"># delete the file</span>
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>Write field to the VTK file.</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;mytestfile.vtk&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>  <span class="c1"># write the file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>  <span class="c1"># delete the file</span>
</pre></div>
</div>
<ol class="arabic simple" start="3">
<li><p>Write field to the HDF5 file.</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;mytestfile.hdf5&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>  <span class="c1"># write the file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field_read</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="o">.</span><span class="n">fromfile</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>  <span class="c1"># read the file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field_read</span> <span class="o">==</span> <span class="n">field</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>  <span class="c1"># delete the file</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#discretisedfield.Field.fromfile" title="discretisedfield.Field.fromfile"><code class="xref py py-func docutils literal notranslate"><span class="pre">fromfile()</span></code></a></p>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="discretisedfield.Field.angle">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">angle</span></span><a class="headerlink" href="#discretisedfield.Field.angle" title="Permalink to this definition">¶</a></dt>
<dd><p>In-plane angle of the vector field.</p>
<p>This method can be applied only on sliced fields, when a plane is
defined. This method then returns a scalar field which is an angle
between the in-plane compoenent of the vector field and the horizontal
axis. The angle is computed in radians and all values are in <span class="math notranslate nohighlight">\((0,
2\pi)\)</span> range.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Angle scalar field.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="#discretisedfield.Field" title="discretisedfield.Field">discretisedfield.Field</a></p>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><strong>ValueError</strong> – If the field is not sliced.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<ol class="arabic simple">
<li><p>Computing the angle of the field in yz-plane.</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">discretisedfield</span> <span class="k">as</span> <span class="nn">df</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Mesh</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="n">p2</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">abs</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">plane</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">angle</span><span class="o">.</span><span class="n">average</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1e-3</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="discretisedfield.Field.array">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">array</span></span><a class="headerlink" href="#discretisedfield.Field.array" title="Permalink to this definition">¶</a></dt>
<dd><p>Field value as <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>.</p>
<p>The shape of the array is <code class="docutils literal notranslate"><span class="pre">(*mesh.n,</span> <span class="pre">dim)</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>array</strong> (<em>numpy.ndarray</em>) – Array with shape <code class="docutils literal notranslate"><span class="pre">(*mesh.n,</span> <span class="pre">dim)</span></code>.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Field values array.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – If unsupported type or shape is passed.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<ol class="arabic simple">
<li><p>Accessing and setting the field array.</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">discretisedfield</span> <span class="k">as</span> <span class="nn">df</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cell</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Mesh</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="n">p2</span><span class="p">,</span> <span class="n">cell</span><span class="o">=</span><span class="n">cell</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">value</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="o">=</span><span class="n">mesh</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">value</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span><span class="o">.</span><span class="n">array</span>
<span class="go">array(...)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span><span class="o">.</span><span class="n">average</span>
<span class="go">(0.0, 0.0, 1.0)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span><span class="o">.</span><span class="n">array</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(2, 1, 1, 3)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span><span class="o">.</span><span class="n">array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span><span class="o">.</span><span class="n">array</span>
<span class="go">array(...)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span><span class="o">.</span><span class="n">average</span>
<span class="go">(1.0, 1.0, 1.0)</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#discretisedfield.Field.value" title="discretisedfield.Field.value"><code class="xref py py-func docutils literal notranslate"><span class="pre">value()</span></code></a></p>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="discretisedfield.Field.average">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">average</span></span><a class="headerlink" href="#discretisedfield.Field.average" title="Permalink to this definition">¶</a></dt>
<dd><p>Field average.</p>
<p>It computes the average of the field over the entire volume of the
mesh. It returns a tuple with the length same as the dimension
(<code class="docutils literal notranslate"><span class="pre">dim</span></code>) of the field.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Field average tuple, whose length equals to the field’s dimension.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>tuple</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<ol class="arabic simple">
<li><p>Computing the vector field average.</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">discretisedfield</span> <span class="k">as</span> <span class="nn">df</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cell</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Mesh</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="n">p2</span><span class="p">,</span> <span class="n">cell</span><span class="o">=</span><span class="n">cell</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="o">=</span><span class="n">mesh</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span><span class="o">.</span><span class="n">average</span>
<span class="go">(0.0, 0.0, 1.0)</span>
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>Computing the scalar field average.</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">field</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="o">=</span><span class="n">mesh</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">55</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span><span class="o">.</span><span class="n">average</span>
<span class="go">55.0</span>
</pre></div>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="discretisedfield.Field.curl">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">curl</span></span><a class="headerlink" href="#discretisedfield.Field.curl" title="Permalink to this definition">¶</a></dt>
<dd><p>Curl.</p>
<p>This method computes the curl of a vector (<code class="docutils literal notranslate"><span class="pre">dim=3</span></code>) field and returns
a vector (<code class="docutils literal notranslate"><span class="pre">dim=3</span></code>) as a result:</p>
<div class="math notranslate nohighlight">
\[\nabla \times \mathbf{v} = \left(\frac{\partial
v_{z}}{\partial y} - \frac{\partial v_{y}}{\partial z},
\frac{\partial v_{x}}{\partial z} - \frac{\partial
v_{z}}{\partial x}, \frac{\partial v_{y}}{\partial x} -
\frac{\partial v_{x}}{\partial y},\right)\]</div>
<p>Directional derivative cannot be computed if only one discretisation
cell exists in a certain direction. In that case, a zero field is
considered to be that directional derivative. More precisely, it is
assumed that the field does not change in that direction.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Resulting field.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="#discretisedfield.Field" title="discretisedfield.Field">discretisedfield.Field</a></p>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><strong>ValueError</strong> – If the dimension of the field is not 3.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>1. Compute curl of a vector field. For a field we choose
<span class="math notranslate nohighlight">\(\mathbf{v}(x, y, z) = (2xy, -2y, 5xz)\)</span>. Accordingly, we expect
the curl to be to be a constant vector field <span class="math notranslate nohighlight">\(\nabla\times
\mathbf{v} = (0, -5z, -2x)\)</span>.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">discretisedfield</span> <span class="k">as</span> <span class="nn">df</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cell</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Mesh</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="n">p2</span><span class="p">,</span> <span class="n">cell</span><span class="o">=</span><span class="n">cell</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">value_fun</span><span class="p">(</span><span class="n">point</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="n">point</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">y</span><span class="p">,</span> <span class="mi">5</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">z</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">value_fun</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">curl</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="go">(0.0, -5.0, -2.0)</span>
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>Attempt to compute the curl of a scalar field.</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mf">3.14</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">curl</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">...</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#discretisedfield.Field.derivative" title="discretisedfield.Field.derivative"><code class="xref py py-func docutils literal notranslate"><span class="pre">derivative()</span></code></a></p>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="discretisedfield.Field.div">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">div</span></span><a class="headerlink" href="#discretisedfield.Field.div" title="Permalink to this definition">¶</a></dt>
<dd><p>Divergence.</p>
<p>This method computes the divergence of a vector (<code class="docutils literal notranslate"><span class="pre">dim=3</span></code>) field and
returns a scalar (<code class="docutils literal notranslate"><span class="pre">dim=1</span></code>) field as a result.</p>
<div class="math notranslate nohighlight">
\[\nabla\cdot\mathbf{v} = \frac{\partial v_{x}}{\partial x} +
                           \frac{\partial v_{y}}{\partial y} +
                           \frac{\partial v_{z}}{\partial z}\]</div>
<p>Directional derivative cannot be computed if only one discretisation
cell exists in a certain direction. In that case, a zero field is
considered to be that directional derivative. More precisely, it is
assumed that the field does not change in that direction.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Resulting field.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="#discretisedfield.Field" title="discretisedfield.Field">discretisedfield.Field</a></p>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><strong>ValueError</strong> – If the dimension of the field is not 3.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>1. Compute the divergence of a vector field. For a field we choose
<span class="math notranslate nohighlight">\(\mathbf{v}(x, y, z) = (2x, -2y, 5z)\)</span>. Accordingly, we expect
the divergence to be to be a constant scalar field <span class="math notranslate nohighlight">\(\nabla\cdot
\mathbf{v} = 5\)</span>.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">discretisedfield</span> <span class="k">as</span> <span class="nn">df</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p2</span> <span class="o">=</span> <span class="p">(</span><span class="mf">100e-9</span><span class="p">,</span> <span class="mf">100e-9</span><span class="p">,</span> <span class="mf">100e-9</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cell</span> <span class="o">=</span> <span class="p">(</span><span class="mf">10e-9</span><span class="p">,</span> <span class="mf">10e-9</span><span class="p">,</span> <span class="mf">10e-9</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Mesh</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="n">p2</span><span class="p">,</span> <span class="n">cell</span><span class="o">=</span><span class="n">cell</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">value_fun</span><span class="p">(</span><span class="n">point</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="n">point</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">y</span><span class="p">,</span> <span class="mi">5</span><span class="o">*</span><span class="n">z</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">value_fun</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">div</span><span class="o">.</span><span class="n">average</span>
<span class="go">5.0</span>
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>Attempt to compute the divergence of a scalar field.</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mf">3.14</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">div</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">...</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#discretisedfield.Field.derivative" title="discretisedfield.Field.derivative"><code class="xref py py-func docutils literal notranslate"><span class="pre">derivative()</span></code></a></p>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="discretisedfield.Field.grad">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">grad</span></span><a class="headerlink" href="#discretisedfield.Field.grad" title="Permalink to this definition">¶</a></dt>
<dd><p>Gradient.</p>
<p>This method computes the gradient of a scalar (<code class="docutils literal notranslate"><span class="pre">dim=1</span></code>) field and
returns a vector field:</p>
<div class="math notranslate nohighlight">
\[\nabla f = (\frac{\partial f}{\partial x},
             \frac{\partial f}{\partial y},
             \frac{\partial f}{\partial z})\]</div>
<p>Directional derivative cannot be computed if only one discretisation
cell exists in a certain direction. In that case, a zero field is
considered to be that directional derivative. More precisely, it is
assumed that the field does not change in that direction.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Resulting field.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="#discretisedfield.Field" title="discretisedfield.Field">discretisedfield.Field</a></p>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><strong>ValueError</strong> – If the dimension of the field is not 1.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<ol class="arabic simple">
<li><p>Compute gradient of a contant field.</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">discretisedfield</span> <span class="k">as</span> <span class="nn">df</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p2</span> <span class="o">=</span> <span class="p">(</span><span class="mf">10e-9</span><span class="p">,</span> <span class="mf">10e-9</span><span class="p">,</span> <span class="mf">10e-9</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cell</span> <span class="o">=</span> <span class="p">(</span><span class="mf">2e-9</span><span class="p">,</span> <span class="mf">2e-9</span><span class="p">,</span> <span class="mf">2e-9</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Mesh</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="n">p2</span><span class="p">,</span> <span class="n">cell</span><span class="o">=</span><span class="n">cell</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">average</span>
<span class="go">(0.0, 0.0, 0.0)</span>
</pre></div>
</div>
<p>2. Compute gradient of a spatially varying field. For a field we choose
<span class="math notranslate nohighlight">\(f(x, y, z) = 2x + 3y - 5z\)</span>. Accordingly, we expect the gradient
to be a constant vector field <span class="math notranslate nohighlight">\(\nabla f = (2, 3, -5)\)</span>.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">value_fun</span><span class="p">(</span><span class="n">point</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="n">point</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">y</span> <span class="o">-</span> <span class="mi">5</span><span class="o">*</span><span class="n">z</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">value_fun</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">average</span>
<span class="go">(2.0, 3.0, -5.0)</span>
</pre></div>
</div>
<ol class="arabic simple" start="3">
<li><p>Attempt to compute the gradient of a vector field.</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">grad</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">...</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#discretisedfield.Field.derivative" title="discretisedfield.Field.derivative"><code class="xref py py-func docutils literal notranslate"><span class="pre">derivative()</span></code></a></p>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="discretisedfield.Field.laplace">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">laplace</span></span><a class="headerlink" href="#discretisedfield.Field.laplace" title="Permalink to this definition">¶</a></dt>
<dd><p>Laplace operator.</p>
<p>This method computes the laplacian of a scalar (<code class="docutils literal notranslate"><span class="pre">dim=1</span></code>) or a vector
(<code class="docutils literal notranslate"><span class="pre">dim=3</span></code>) field and returns a resulting field:</p>
<div class="math notranslate nohighlight">
\[\nabla^2 f = \frac{\partial^{2} f}{\partial x^{2}} +
              \frac{\partial^{2} f}{\partial y^{2}} +
              \frac{\partial^{2} f}{\partial z^{2}}\]</div>
<div class="math notranslate nohighlight">
\[\nabla^2 \mathbf{f} = (\nabla^2 f_{x},
                         \nabla^2 f_{y},
                         \nabla^2 f_{z})\]</div>
<p>Directional derivative cannot be computed if only one discretisation
cell exists in a certain direction. In that case, a zero field is
considered to be that directional derivative. More precisely, it is
assumed that the field does not change in that direction.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Resulting field.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="#discretisedfield.Field" title="discretisedfield.Field">discretisedfield.Field</a></p>
</dd>
</dl>
<p class="rubric">Example</p>
<ol class="arabic simple">
<li><p>Compute Laplacian of a contant scalar field.</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">discretisedfield</span> <span class="k">as</span> <span class="nn">df</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p2</span> <span class="o">=</span> <span class="p">(</span><span class="mf">10e-9</span><span class="p">,</span> <span class="mf">10e-9</span><span class="p">,</span> <span class="mf">10e-9</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cell</span> <span class="o">=</span> <span class="p">(</span><span class="mf">2e-9</span><span class="p">,</span> <span class="mf">2e-9</span><span class="p">,</span> <span class="mf">2e-9</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Mesh</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="n">p2</span><span class="p">,</span> <span class="n">cell</span><span class="o">=</span><span class="n">cell</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">laplace</span><span class="o">.</span><span class="n">average</span>
<span class="go">0.0</span>
</pre></div>
</div>
<p>2. Compute Laplacian of a spatially varying field. For a field we
choose <span class="math notranslate nohighlight">\(f(x, y, z) = 2x^{2} + 3y - 5z\)</span>. Accordingly, we expect
the Laplacian to be a constant vector field <span class="math notranslate nohighlight">\(\nabla f = (4, 0,
0)\)</span>.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">value_fun</span><span class="p">(</span><span class="n">point</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="n">point</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">y</span> <span class="o">-</span> <span class="mi">5</span><span class="o">*</span><span class="n">z</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">value_fun</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">abs</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">laplace</span><span class="o">.</span><span class="n">average</span> <span class="o">-</span> <span class="mi">4</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1e-3</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#discretisedfield.Field.derivative" title="discretisedfield.Field.derivative"><code class="xref py py-func docutils literal notranslate"><span class="pre">derivative()</span></code></a></p>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="discretisedfield.Field.norm">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">norm</span></span><a class="headerlink" href="#discretisedfield.Field.norm" title="Permalink to this definition">¶</a></dt>
<dd><p>Norm of the field.</p>
<p>Computes the norm of the field and returns <code class="docutils literal notranslate"><span class="pre">discretisedfield.Field</span></code>
with <code class="docutils literal notranslate"><span class="pre">dim=1</span></code>. Norm of a scalar field is interpreted as an absolute
value of the field. Alternatively, <code class="docutils literal notranslate"><span class="pre">discretisedfield.Field.__abs__</span></code>
can be called for obtaining the norm of the field.</p>
<p>The field norm can be set by passing <code class="docutils literal notranslate"><span class="pre">numbers.Real</span></code>,
<code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>, or callable. If the field has <code class="docutils literal notranslate"><span class="pre">dim=1</span></code> or it
contains zero values, norm cannot be set and <code class="docutils literal notranslate"><span class="pre">ValueError</span></code> is raised.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>numbers.Real</strong> – Norm value.</p></li>
<li><p><strong>numpy.ndarray</strong> – Norm value.</p></li>
<li><p><strong>callable</strong> – Norm value.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Norm of the field if <code class="docutils literal notranslate"><span class="pre">dim&gt;1</span></code> or absolute value for <code class="docutils literal notranslate"><span class="pre">dim=1</span></code>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#discretisedfield.Field" title="discretisedfield.Field">discretisedfield.Field</a></p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the norm is set with wrong type, shape, or value. In addition,
    if the field is scalar (<code class="docutils literal notranslate"><span class="pre">dim=1</span></code>) or the field contains zero
    values.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<ol class="arabic simple">
<li><p>Manipulating the field norm.</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">discretisedfield</span> <span class="k">as</span> <span class="nn">df</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cell</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Mesh</span><span class="p">(</span><span class="n">region</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">Region</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="n">p2</span><span class="p">),</span> <span class="n">cell</span><span class="o">=</span><span class="n">cell</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="o">=</span><span class="n">mesh</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span><span class="o">.</span><span class="n">norm</span>
<span class="go">Field(...)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">average</span>
<span class="go">1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span><span class="o">.</span><span class="n">norm</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span><span class="o">.</span><span class="n">average</span>
<span class="go">(0.0, 0.0, 2.0)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">average</span>
<span class="go">1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># An attempt to set the norm for a zero field.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span><span class="o">.</span><span class="n">average</span>
<span class="go">(0.0, 0.0, 0.0)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span><span class="o">.</span><span class="n">norm</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">...</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#discretisedfield.Field.__abs__" title="discretisedfield.Field.__abs__"><code class="xref py py-func docutils literal notranslate"><span class="pre">__abs__()</span></code></a></p>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="discretisedfield.Field.orientation">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">orientation</span></span><a class="headerlink" href="#discretisedfield.Field.orientation" title="Permalink to this definition">¶</a></dt>
<dd><p>Orientation field.</p>
<p>This method computes the orientation (direction) of a vector field and
returns <code class="docutils literal notranslate"><span class="pre">discretisedfield.Field</span></code> with the same dimension. More
precisely, at every mesh discretisation cell, the vector is divided by
its norm, so that a unit vector is obtained. However, if the vector at
a discretisation cell is a zero-vector, it remains unchanged. In the
case of a scalar (<code class="docutils literal notranslate"><span class="pre">dim=1</span></code>) field, <code class="docutils literal notranslate"><span class="pre">ValueError</span></code> is raised.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Orientation field.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="#discretisedfield.Field" title="discretisedfield.Field">discretisedfield.Field</a></p>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><strong>ValueError</strong> – If the field is has <code class="docutils literal notranslate"><span class="pre">dim=1</span></code>.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<ol class="arabic simple">
<li><p>Computing the orientation field.</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">discretisedfield</span> <span class="k">as</span> <span class="nn">df</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cell</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Mesh</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="n">p2</span><span class="p">,</span> <span class="n">cell</span><span class="o">=</span><span class="n">cell</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="o">=</span><span class="n">mesh</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span><span class="o">.</span><span class="n">orientation</span>
<span class="go">Field(...)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span><span class="o">.</span><span class="n">orientation</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">average</span>
<span class="go">1.0</span>
</pre></div>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="discretisedfield.Field.value">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">value</span></span><a class="headerlink" href="#discretisedfield.Field.value" title="Permalink to this definition">¶</a></dt>
<dd><p>Field value representation.</p>
<p>This property returns a representation of the field value if it exists.
Otherwise, <code class="docutils literal notranslate"><span class="pre">discretisedfield.Field.array</span></code> containing all field values
is returned.</p>
<p>The value of the field can be set using a scalar value for <code class="docutils literal notranslate"><span class="pre">dim=1</span></code>
fields (e.g. <code class="docutils literal notranslate"><span class="pre">value=3</span></code>) or <code class="docutils literal notranslate"><span class="pre">array_like</span></code> value for <code class="docutils literal notranslate"><span class="pre">dim&gt;1</span></code> fields
(e.g. <code class="docutils literal notranslate"><span class="pre">value=(1,</span> <span class="pre">2,</span> <span class="pre">3)</span></code>). Alternatively, the value can be defined
using a callable object, which takes a point tuple as an input argument
and returns a value of appropriate dimension. Internally, callable
object is called for every point in the mesh on which the field is
defined. For instance, callable object can be a Python function or
another <code class="docutils literal notranslate"><span class="pre">discretisedfield.Field</span></code>. Finally, <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code> with
shape <code class="docutils literal notranslate"><span class="pre">(*self.mesh.n,</span> <span class="pre">dim)</span></code> can be passed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>value</strong> (<em>numbers.Real</em><em>, </em><em>array_like</em><em>, </em><em>callable</em><em>, </em><em>dict</em>) – <p>For scalar fields (<code class="docutils literal notranslate"><span class="pre">dim=1</span></code>) <code class="docutils literal notranslate"><span class="pre">numbers.Real</span></code> values are allowed.
In the case of vector fields, <code class="docutils literal notranslate"><span class="pre">array_like</span></code> (list, tuple,
numpy.ndarray) value with length equal to <cite>dim</cite> should be used.
Finally, the value can also be a callable (e.g. Python function or
another field), which for every coordinate in the mesh returns a
valid value. If <code class="docutils literal notranslate"><span class="pre">value=0</span></code>, all values in the field will be set to
zero independent of the field dimension.</p>
<p>If subregions are defined value can be initialised with a dict.
Allowed keys are names of all subregions and <code class="docutils literal notranslate"><span class="pre">default</span></code>. Items
must be either <code class="docutils literal notranslate"><span class="pre">numbers.Real</span></code> for <code class="docutils literal notranslate"><span class="pre">dim=1</span></code> or <code class="docutils literal notranslate"><span class="pre">array_like</span></code>
for <code class="docutils literal notranslate"><span class="pre">dim=3</span></code>. If subregion names are missing, the value of
<code class="docutils literal notranslate"><span class="pre">default</span></code> is used if given. If parts of the region are not
contained within one subregion <code class="docutils literal notranslate"><span class="pre">default</span></code> is used if specified,
else these values are set to 0.</p>
</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The value used (representation) for setting the field is returned.
However, if the actual value of the field does not correspond to
the initially used value anymore, a <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code> is returned
containing all field values.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array_like, callable, numbers.Real, numpy.ndarray</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – If unsupported type is passed.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<ol class="arabic simple">
<li><p>Different ways of setting and getting the field value.</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">discretisedfield</span> <span class="k">as</span> <span class="nn">df</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cell</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Mesh</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="n">p2</span><span class="p">,</span> <span class="n">cell</span><span class="o">=</span><span class="n">cell</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">value</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># if value is not specified, zero-field is defined</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="o">=</span><span class="n">mesh</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span><span class="o">.</span><span class="n">value</span>
<span class="go">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span><span class="o">.</span><span class="n">value</span>
<span class="go">(0, 0, 1)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Setting the field value using a Python function (callable).</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">value_function</span><span class="p">(</span><span class="n">point</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="n">point</span>
<span class="gp">... </span>    <span class="k">if</span> <span class="n">x</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">... </span>    <span class="k">else</span><span class="p">:</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">value_function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span><span class="o">.</span><span class="n">value</span>
<span class="go">&lt;function value_function at ...&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># We now change the value of a single cell so that the</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># representation used for initialising field is not valid</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># anymore.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span><span class="o">.</span><span class="n">array</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span><span class="o">.</span><span class="n">value</span>
<span class="go">array(...)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(2, 2, 1, 3)</span>
</pre></div>
</div>
<p>2. Field with subregions in mesh
&gt;&gt;&gt; import discretisedfield as df
…
&gt;&gt;&gt; p1 = (0,0,0)
&gt;&gt;&gt; p2 = (2,2,2)
&gt;&gt;&gt; cell = (1,1,1)
&gt;&gt;&gt; sub1 = df.Region(p1=(0,0,0), p2=(2,2,1))
&gt;&gt;&gt; sub2 = df.Region(p1=(0,0,1), p2=(2,2,2))
&gt;&gt;&gt; mesh = df.Mesh(p1=p1, p2=p2, cell=cell,                           subregions={‘s1’: sub1, ‘s2’: sub2})
&gt;&gt;&gt; field = df.Field(mesh, dim=1, value={‘s1’: 1, ‘s2’: 1})
&gt;&gt;&gt; (field.array == 1).all()
True
&gt;&gt;&gt; field = df.Field(mesh, dim=1, value={‘s1’: 1})
Traceback (most recent call last):
…
KeyError: …
&gt;&gt;&gt; field = df.Field(mesh, dim=1, value={‘s1’: 2, ‘default’: 1})
&gt;&gt;&gt; (field.array == 1).all()
False
&gt;&gt;&gt; (field.array == 0).any()
False
&gt;&gt;&gt; mesh = df.Mesh(p1=p1, p2=p2, cell=cell, subregions={‘s’: sub1})
&gt;&gt;&gt; field = df.Field(mesh, dim=1, value={‘s’: 1})
Traceback (most recent call last):
…
KeyError: …
&gt;&gt;&gt; field = df.Field(mesh, dim=1, value={‘default’: 1})
&gt;&gt;&gt; (field.array == 1).all()
True</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#discretisedfield.Field.array" title="discretisedfield.Field.array"><code class="xref py py-func docutils literal notranslate"><span class="pre">array()</span></code></a></p>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="discretisedfield.Field.zero">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">zero</span></span><a class="headerlink" href="#discretisedfield.Field.zero" title="Permalink to this definition">¶</a></dt>
<dd><p>Zero field.</p>
<p>This method returns a zero field defined on the same mesh and with the
same value dimension.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Zero field.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="#discretisedfield.Field" title="discretisedfield.Field">discretisedfield.Field</a></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<ol class="arabic simple">
<li><p>Getting the zero-field.</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">discretisedfield</span> <span class="k">as</span> <span class="nn">df</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">13</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cell</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Mesh</span><span class="p">(</span><span class="n">region</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">Region</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="n">p2</span><span class="p">),</span> <span class="n">cell</span><span class="o">=</span><span class="n">cell</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="o">=</span><span class="n">mesh</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">zero_field</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">zero</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">zero_field</span><span class="o">.</span><span class="n">average</span>
<span class="go">(0.0, 0.0, 0.0)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</div>


              </div>
              
              
              <div class='prev-next-bottom'>
                
    <a class='left-prev' id="prev-link" href="discretisedfield.DValue.html" title="previous page">DValue</a>
    <a class='right-next' id="next-link" href="discretisedfield.Line.html" title="next page">Line</a>

              </div>
              
          </main>
          

      </div>
    </div>
  
  <script src="../../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  <footer class="footer mt-5 mt-md-0">
  <div class="container">
    
    <div class="footer-item">
      <p class="copyright">
    &copy; Copyright 2021, Marijan Beg and Hans Fangohr.<br/>
</p>
    </div>
    
    <div class="footer-item">
      <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.1.2.<br/>
</p>
    </div>
    
  </div>
</footer>
  </body>
</html>